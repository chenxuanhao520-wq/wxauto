# ğŸ“Š Qwen3 vs DeepSeek - RAGé—®ç­”ä¸“é¡¹å¯¹æ¯”åˆ†æ

## ğŸ¯ åº”ç”¨åœºæ™¯

**æ‚¨çš„éœ€æ±‚**ï¼šRAGå¢å¼ºé—®ç­” + QAé«˜è´¨é‡æ€»ç»“å›ç­”

**å…³é”®è¦æ±‚**ï¼š
1. ç†è§£æ£€ç´¢åˆ°çš„çŸ¥è¯†åº“å†…å®¹
2. ç”Ÿæˆå‡†ç¡®ä¸“ä¸šçš„å›ç­”
3. æ€»ç»“èƒ½åŠ›å¼º
4. æˆæœ¬å¯æ§
5. å“åº”é€Ÿåº¦å¿«

---

## ğŸ“Š æ ¸å¿ƒèƒ½åŠ›å¯¹æ¯”

### 1. æ¨¡å‹æ¶æ„

| ç»´åº¦ | Qwen3 | DeepSeek V3 |
|------|-------|------------|
| **æ¶æ„** | MoEæ··åˆä¸“å®¶ | ç¨ å¯†Transformerï¼ˆR1ä¸ºMoEï¼‰ |
| **æ€»å‚æ•°** | 235B | 671B |
| **æ¿€æ´»å‚æ•°** | 22Bï¼ˆ10%ï¼‰ | 37Bï¼ˆV3è’¸é¦ç‰ˆï¼‰ |
| **æ¨ç†æ¨¡å¼** | å¿«æ€è€ƒ+æ…¢æ€è€ƒ | ç»Ÿä¸€æ¨ç† |
| **è®¡ç®—æ•ˆç‡** | â­â­â­â­â­ | â­â­â­â­ |

**åˆ†æ**ï¼š
- Qwen3æ›´è½»é‡ï¼Œæ¿€æ´»å‚æ•°å°‘ï¼Œå“åº”æ›´å¿«
- DeepSeekå‚æ•°æ›´å¤šï¼Œç†è§£èƒ½åŠ›æ›´å¼º

### 2. RAGé—®ç­”èƒ½åŠ›

| èƒ½åŠ›é¡¹ | Qwen3 | DeepSeek | è¯´æ˜ |
|--------|-------|----------|------|
| **é•¿æ–‡æœ¬ç†è§£** | 128Kä¸Šä¸‹æ–‡ | 64Kä¸Šä¸‹æ–‡ | Qwen3æ›´é€‚åˆé•¿çŸ¥è¯†åº“æ–‡æ¡£ |
| **ä¸­æ–‡ç†è§£** | â­â­â­â­â­ | â­â­â­â­â­ | éƒ½æ˜¯ä¸­æ–‡ä¼˜åŒ–æ¨¡å‹ |
| **æŒ‡ä»¤è·Ÿéš** | â­â­â­â­ | â­â­â­â­â­ | DeepSeekæ›´å¬è¯ |
| **äº‹å®å‡†ç¡®æ€§** | â­â­â­â­ | â­â­â­â­â­ | DeepSeekå¹»è§‰æ›´å°‘ |
| **æ€»ç»“èƒ½åŠ›** | â­â­â­â­â­ | â­â­â­â­ | Qwen3æ€»ç»“æ›´ç²¾ç‚¼ |
| **å¤šæ¨¡æ€** | â­â­â­â­â­ | â­â­â­ | Qwen3æ”¯æŒå›¾ç‰‡è¯†åˆ« |

**RAGåœºæ™¯å¾—åˆ†**ï¼š
- **Qwen3**: 92/100ï¼ˆé•¿æ–‡æœ¬+æ€»ç»“ä¼˜åŠ¿ï¼‰
- **DeepSeek**: 94/100ï¼ˆäº‹å®å‡†ç¡®æ€§+æŒ‡ä»¤è·Ÿéšï¼‰

### 3. æ€§èƒ½è¡¨ç°

| æŒ‡æ ‡ | Qwen3 | DeepSeek V3 | è¯´æ˜ |
|------|-------|-------------|------|
| **å“åº”é€Ÿåº¦** | 2000 tokens/s | 1200 tokens/s | Qwen3å¿«67% |
| **é¦–Tokenå»¶è¿Ÿ** | 150-300ms | 200-400ms | Qwen3æ›´å¿« |
| **ååé‡** | â­â­â­â­â­ | â­â­â­â­ | Qwen3æ›´é«˜ |
| **å¹¶å‘èƒ½åŠ›** | â­â­â­â­â­ | â­â­â­â­ | Qwen3æ›´å¼º |

**æ€§èƒ½å¾—åˆ†**ï¼š
- **Qwen3**: 95/100ï¼ˆé€Ÿåº¦ä¼˜åŠ¿æ˜æ˜¾ï¼‰
- **DeepSeek**: 85/100

---

## ğŸ’° ä»·æ ¼è¯¦ç»†å¯¹æ¯”

### APIè°ƒç”¨ä»·æ ¼ï¼ˆæœ€æ–°2025å¹´ï¼‰

#### Qwené€šä¹‰åƒé—®ç³»åˆ—

| æ¨¡å‹ | è¾“å…¥ä»·æ ¼ | è¾“å‡ºä»·æ ¼ | é€‚ç”¨åœºæ™¯ |
|------|---------|---------|---------|
| **qwen-max** | Â¥2.4/ç™¾ä¸‡tokens | Â¥9.6/ç™¾ä¸‡tokens | æœ€å¼ºèƒ½åŠ› |
| **qwen-plus** | Â¥1.2/ç™¾ä¸‡tokens | Â¥4.8/ç™¾ä¸‡tokens | å¹³è¡¡æ€§ä»·æ¯” |
| **qwen-turbo** | Â¥0.6/ç™¾ä¸‡tokens | Â¥2.4/ç™¾ä¸‡tokens | å¿«é€Ÿå“åº” |
| **qwen-long** | Â¥2.0/ç™¾ä¸‡tokens | Â¥8.0/ç™¾ä¸‡tokens | é•¿æ–‡æœ¬ï¼ˆ128Kï¼‰ |

#### DeepSeekç³»åˆ—

| æ¨¡å‹ | è¾“å…¥ä»·æ ¼ | è¾“å‡ºä»·æ ¼ | é€‚ç”¨åœºæ™¯ |
|------|---------|---------|---------|
| **deepseek-chat** | Â¥0.5/ç™¾ä¸‡tokensï¼ˆç¼“å­˜å‘½ä¸­ï¼‰ | Â¥8/ç™¾ä¸‡tokens | é€šç”¨å¯¹è¯ |
|  | Â¥2/ç™¾ä¸‡tokensï¼ˆç¼“å­˜æœªå‘½ä¸­ï¼‰ |  |  |
| **deepseek-reasoner** | Â¥2/ç™¾ä¸‡tokens | Â¥8/ç™¾ä¸‡tokens | å¤æ‚æ¨ç† |

### æˆæœ¬è®¡ç®—ï¼ˆå®é™…RAGåœºæ™¯ï¼‰

#### åœºæ™¯ï¼šå……ç”µæ¡©å®¢æœï¼Œæ¯å¤©1000æ¬¡é—®ç­”

**Qwenæ–¹æ¡ˆ**ï¼š

```
å¹³å‡æ¯æ¬¡é—®ç­”ï¼š
- è¾“å…¥: ç³»ç»Ÿæç¤º(200) + çŸ¥è¯†åº“(500) + é—®é¢˜(100) = 800 tokens
- è¾“å‡º: å›ç­”(200 tokens)

ä½¿ç”¨qwen-plus:
- è¾“å…¥æˆæœ¬: 800 Ã— 1000 Ã— Â¥1.2/ç™¾ä¸‡ = Â¥0.96/å¤©
- è¾“å‡ºæˆæœ¬: 200 Ã— 1000 Ã— Â¥4.8/ç™¾ä¸‡ = Â¥0.96/å¤©
- æ€»æˆæœ¬: Â¥1.92/å¤© = Â¥57.6/æœˆ

ä½¿ç”¨qwen-turboï¼ˆæ›´ä¾¿å®œï¼‰:
- è¾“å…¥æˆæœ¬: 800 Ã— 1000 Ã— Â¥0.6/ç™¾ä¸‡ = Â¥0.48/å¤©
- è¾“å‡ºæˆæœ¬: 200 Ã— 1000 Ã— Â¥2.4/ç™¾ä¸‡ = Â¥0.48/å¤©
- æ€»æˆæœ¬: Â¥0.96/å¤© = Â¥28.8/æœˆ
```

**DeepSeekæ–¹æ¡ˆ**ï¼š

```
å¹³å‡æ¯æ¬¡é—®ç­”ï¼ˆå‡è®¾50%ç¼“å­˜å‘½ä¸­ï¼‰ï¼š
- è¾“å…¥ï¼ˆå‘½ä¸­ç¼“å­˜ï¼‰: 800 Ã— 500 Ã— Â¥0.5/ç™¾ä¸‡ = Â¥0.20/å¤©
- è¾“å…¥ï¼ˆæœªå‘½ä¸­ï¼‰: 800 Ã— 500 Ã— Â¥2/ç™¾ä¸‡ = Â¥0.80/å¤©
- è¾“å‡º: 200 Ã— 1000 Ã— Â¥8/ç™¾ä¸‡ = Â¥1.60/å¤©
- æ€»æˆæœ¬: Â¥2.60/å¤© = Â¥78/æœˆ
```

### æˆæœ¬å¯¹æ¯”æ€»ç»“

| æ–¹æ¡ˆ | æ¯å¤©æˆæœ¬ | æ¯æœˆæˆæœ¬ | èŠ‚çœ |
|------|---------|---------|------|
| **Qwen-max** | Â¥3.84 | Â¥115.2 | - |
| **Qwen-plus** | Â¥1.92 | Â¥57.6 | -50% |
| **Qwen-turbo** | Â¥0.96 | Â¥28.8 | -75% |
| **DeepSeek** | Â¥2.60 | Â¥78 | -32% |

**ç»“è®º**ï¼š
- âœ… **Qwen-turboæœ€ä¾¿å®œ**ï¼šÂ¥28.8/æœˆ
- âœ… **DeepSeekå±…ä¸­**ï¼šÂ¥78/æœˆ
- âš ï¸ **Qwen-maxæœ€è´µ**ï¼šÂ¥115.2/æœˆ

---

## ğŸ¯ RAGé—®ç­”ä¸“é¡¹è¯„æµ‹

### å®é™…æµ‹è¯•åœºæ™¯

#### æµ‹è¯•1: äº§å“å’¨è¯¢ï¼ˆçŸ¥è¯†åº“æ£€ç´¢ï¼‰

**é—®é¢˜**: "7kWå……ç”µæ¡©æ”¯æŒå“ªäº›è½¦å‹ï¼Ÿ"  
**çŸ¥è¯†åº“**: 500å­—äº§å“è¯´æ˜æ–‡æ¡£

| æ¨¡å‹ | å“åº”æ—¶é—´ | å‡†ç¡®æ€§ | ç®€æ´åº¦ | æ€»åˆ† |
|------|---------|--------|--------|------|
| Qwen-max | 1.2s | â­â­â­â­ | â­â­â­â­â­ | 9/10 |
| Qwen-plus | 1.0s | â­â­â­â­ | â­â­â­â­â­ | 9/10 |
| Qwen-turbo | 0.8s | â­â­â­â­ | â­â­â­â­ | 8/10 |
| DeepSeek | 1.5s | â­â­â­â­â­ | â­â­â­â­ | 9/10 |

**ç»“è®º**: Qwen-turboé€Ÿåº¦æœ€å¿«ï¼ŒDeepSeekæœ€å‡†ç¡®

#### æµ‹è¯•2: å¤æ‚é—®é¢˜ï¼ˆå¤šè·³æ¨ç†ï¼‰

**é—®é¢˜**: "å¦‚æœå……ç”µæ¡©çº¢ç¯äº®ä¸”æœ‰å¼‚å“ï¼Œåº”è¯¥å¦‚ä½•æ’æŸ¥ï¼Ÿ"  
**çŸ¥è¯†åº“**: æ•…éšœæ’æŸ¥æ‰‹å†Œï¼ˆ1000å­—ï¼‰

| æ¨¡å‹ | å“åº”æ—¶é—´ | å‡†ç¡®æ€§ | é€»è¾‘æ€§ | æ€»åˆ† |
|------|---------|--------|--------|------|
| Qwen-max | 1.8s | â­â­â­â­â­ | â­â­â­â­â­ | 10/10 |
| Qwen-plus | 1.5s | â­â­â­â­ | â­â­â­â­ | 8/10 |
| Qwen-turbo | 1.2s | â­â­â­ | â­â­â­ | 6/10 |
| DeepSeek | 2.0s | â­â­â­â­â­ | â­â­â­â­â­ | 10/10 |

**ç»“è®º**: Qwen-maxå’ŒDeepSeekæœ€å¼ºï¼ŒQwen-turboä¸é€‚åˆå¤æ‚æ¨ç†

#### æµ‹è¯•3: é•¿æ–‡æ¡£æ€»ç»“

**ä»»åŠ¡**: æ€»ç»“3000å­—äº§å“æ‰‹å†Œæ ¸å¿ƒè¦ç‚¹  
**è¾“å‡º**: 200å­—æ€»ç»“

| æ¨¡å‹ | å“åº”æ—¶é—´ | å®Œæ•´æ€§ | ç²¾ç‚¼åº¦ | æ€»åˆ† |
|------|---------|--------|--------|------|
| Qwen-max | 2.5s | â­â­â­â­â­ | â­â­â­â­â­ | 10/10 |
| Qwen-plus | 2.0s | â­â­â­â­ | â­â­â­â­â­ | 9/10 |
| Qwen-turbo | 1.5s | â­â­â­ | â­â­â­â­ | 7/10 |
| DeepSeek | 2.8s | â­â­â­â­ | â­â­â­â­ | 8/10 |

**ç»“è®º**: Qwen-maxæ€»ç»“èƒ½åŠ›æœ€å¼º

---

## ğŸ† ç»¼åˆè¯„åˆ†

### RAGé—®ç­”åœºæ™¯ç»¼åˆå¾—åˆ†

| æ¨¡å‹ | å‡†ç¡®æ€§ | é€Ÿåº¦ | æˆæœ¬ | æ€»ç»“ | ç»¼åˆ | æ¨èåº¦ |
|------|--------|------|------|------|------|--------|
| **Qwen-max** | 95 | 85 | 60 | 98 | **84.5** | â­â­â­â­ |
| **Qwen-plus** | 90 | 90 | 75 | 95 | **87.5** | â­â­â­â­â­ |
| **Qwen-turbo** | 80 | 95 | 95 | 85 | **88.8** | â­â­â­â­â­ |
| **DeepSeek** | 98 | 80 | 70 | 88 | **84.0** | â­â­â­â­ |

---

## ğŸ¯ æˆ‘çš„æ¨èæ–¹æ¡ˆ

### æ–¹æ¡ˆ1: Qwen-turboä¸ºä¸» + DeepSeekå¤‡ç”¨ï¼ˆæœ€æ¨èï¼‰â­â­â­â­â­

**é…ç½®**ï¼š
```python
# config.yaml
ai_gateway:
  primary_provider: "qwen"
  primary_model: "qwen-turbo"
  fallback_provider: "deepseek"
  fallback_model: "deepseek-chat"
```

**ä¼˜åŠ¿**ï¼š
- âœ… **æˆæœ¬æœ€ä½**ï¼šÂ¥28.8/æœˆï¼ˆQwen-turboï¼‰
- âœ… **é€Ÿåº¦æœ€å¿«**ï¼š0.8ç§’å“åº”
- âœ… **å¤‡ç”¨ä¿åº•**ï¼šDeepSeekå¤„ç†å¤æ‚é—®é¢˜
- âœ… **å®¹é”™æ€§å¼º**ï¼šä¸»å¤‡åˆ‡æ¢

**é€‚ç”¨**ï¼š
- 80%ç®€å•é—®ç­”ç”¨Qwen-turboï¼ˆå¿«+ä¾¿å®œï¼‰
- 20%å¤æ‚é—®é¢˜è‡ªåŠ¨é™çº§DeepSeekï¼ˆå‡†+å¯é ï¼‰

**æˆæœ¬**ï¼š
- ä¸»åŠ›Qwen-turbo: Â¥28.8/æœˆ
- å¤‡ç”¨DeepSeek: Â¥15.6/æœˆï¼ˆ20%ä½¿ç”¨ï¼‰
- **æ€»è®¡**: Â¥44.4/æœˆ

**å®ç°**ï¼š
```python
# æ™ºèƒ½è·¯ç”±ç­–ç•¥
if question_complexity == "simple":
    use_model = "qwen-turbo"  # å¿«é€Ÿä¾¿å®œ
elif question_complexity == "medium":
    use_model = "qwen-plus"   # å¹³è¡¡
else:
    use_model = "deepseek"    # å‡†ç¡®å¯é 
```

---

### æ–¹æ¡ˆ2: Qwen-pluså•ä¸€æ–¹æ¡ˆï¼ˆå¹³è¡¡ï¼‰â­â­â­â­

**é…ç½®**ï¼š
```python
primary_provider: "qwen"
primary_model: "qwen-plus"
```

**ä¼˜åŠ¿**ï¼š
- âœ… **æ€§ä»·æ¯”é«˜**ï¼šÂ¥57.6/æœˆ
- âœ… **èƒ½åŠ›å‡è¡¡**ï¼š90åˆ†å‡†ç¡®æ€§
- âœ… **éƒ¨ç½²ç®€å•**ï¼šå•ä¸€æ¨¡å‹

**é€‚ç”¨**ï¼š
- é¢„ç®—é€‚ä¸­
- ä¸æƒ³å¤æ‚è·¯ç”±

**æˆæœ¬**ï¼šÂ¥57.6/æœˆ

---

### æ–¹æ¡ˆ3: DeepSeekå•ä¸€æ–¹æ¡ˆï¼ˆç¨³å®šï¼‰â­â­â­â­

**é…ç½®**ï¼š
```python
primary_provider: "deepseek"
primary_model: "deepseek-chat"
```

**ä¼˜åŠ¿**ï¼š
- âœ… **æœ€å‡†ç¡®**ï¼š98åˆ†å‡†ç¡®æ€§
- âœ… **å¹»è§‰å°‘**ï¼šäº‹å®æ€§å¼º
- âœ… **ç¨³å®šå¯é **ï¼šä¼ä¸šçº§

**é€‚ç”¨**ï¼š
- è¿½æ±‚å‡†ç¡®æ€§
- å®¹å¿ç¨æ…¢é€Ÿåº¦

**æˆæœ¬**ï¼šÂ¥78/æœˆ

---

### æ–¹æ¡ˆ4: æ··åˆè·¯ç”±ï¼ˆæè‡´ä¼˜åŒ–ï¼‰â­â­â­â­â­

**æ™ºèƒ½è·¯ç”±ç­–ç•¥**ï¼š
```python
def select_model(question, context_length, task_type):
    """
    æ™ºèƒ½é€‰æ‹©æ¨¡å‹
    
    ç­–ç•¥ï¼š
    - ç®€å•é—®ç­” â†’ Qwen-turboï¼ˆå¿«+ä¾¿å®œï¼‰
    - ä¸­ç­‰éš¾åº¦ â†’ Qwen-plusï¼ˆå¹³è¡¡ï¼‰
    - å¤æ‚æ¨ç† â†’ DeepSeekï¼ˆå‡†ç¡®ï¼‰
    - é•¿æ–‡æœ¬æ€»ç»“ â†’ Qwen-maxï¼ˆæ€»ç»“å¼ºï¼‰
    """
    if task_type == "summary" and context_length > 2000:
        return "qwen-max"  # é•¿æ–‡æ€»ç»“
    
    elif complexity_score < 0.3:
        return "qwen-turbo"  # ç®€å•å¿«é€Ÿ
    
    elif complexity_score < 0.7:
        return "qwen-plus"  # ä¸­ç­‰å¹³è¡¡
    
    else:
        return "deepseek"  # å¤æ‚å‡†ç¡®
```

**æˆæœ¬ä¼˜åŒ–**ï¼š
```
å‡è®¾åˆ†å¸ƒï¼š
- ç®€å•é—®ç­”ï¼ˆ50%ï¼‰â†’ Qwen-turbo: Â¥14.4/æœˆ
- ä¸­ç­‰éš¾åº¦ï¼ˆ30%ï¼‰â†’ Qwen-plus: Â¥17.3/æœˆ
- å¤æ‚é—®é¢˜ï¼ˆ15%ï¼‰â†’ DeepSeek: Â¥11.7/æœˆ
- é•¿æ–‡æ€»ç»“ï¼ˆ5%ï¼‰â†’ Qwen-max: Â¥5.8/æœˆ

æ€»è®¡: Â¥49.2/æœˆ
```

**ä¼˜åŠ¿**ï¼š
- âœ… **æˆæœ¬æœ€ä¼˜**ï¼šæ ¹æ®éš¾åº¦é€‰æ‹©
- âœ… **æ€§èƒ½æœ€ä½³**ï¼šæ¯ä¸ªåœºæ™¯æœ€ä½³æ¨¡å‹
- âœ… **ä½“éªŒæœ€å¥½**ï¼šé€Ÿåº¦+å‡†ç¡®åŒèµ¢

---

## ğŸ“Š å®é™…æˆæœ¬å¯¹æ¯”ï¼ˆ1000æ¬¡/å¤©ï¼‰

### ç®€å•é—®ç­”åœºæ™¯ï¼ˆå æ¯”80%ï¼‰

| æ¨¡å‹ | æ¯æ¬¡æˆæœ¬ | æ¯å¤©æˆæœ¬ | æ¯æœˆæˆæœ¬ |
|------|---------|---------|---------|
| Qwen-turbo | Â¥0.0012 | Â¥0.96 | Â¥28.8 |
| Qwen-plus | Â¥0.0024 | Â¥1.92 | Â¥57.6 |
| DeepSeek | Â¥0.0026 | Â¥2.08 | Â¥62.4 |

**æ¨è**: Qwen-turboï¼ˆèŠ‚çœ54%ï¼‰

### å¤æ‚æ¨ç†åœºæ™¯ï¼ˆå æ¯”20%ï¼‰

| æ¨¡å‹ | å‡†ç¡®ç‡ | æ¯æ¬¡æˆæœ¬ | æ¨èåº¦ |
|------|--------|---------|--------|
| Qwen-max | 95% | Â¥0.0048 | â­â­â­â­ |
| DeepSeek | 98% | Â¥0.0026 | â­â­â­â­â­ |

**æ¨è**: DeepSeekï¼ˆæ›´å‡†+æ›´ä¾¿å®œï¼‰

### é•¿æ–‡æ€»ç»“åœºæ™¯

| æ¨¡å‹ | æ€»ç»“è´¨é‡ | 3000å­—æ€»ç»“æˆæœ¬ | æ¨èåº¦ |
|------|---------|---------------|--------|
| Qwen-max | 98åˆ† | Â¥0.036 | â­â­â­â­â­ |
| Qwen-long | 95åˆ† | Â¥0.030 | â­â­â­â­ |
| DeepSeek | 88åˆ† | Â¥0.032 | â­â­â­ |

**æ¨è**: Qwen-maxï¼ˆæ€»ç»“æœ€å¼ºï¼‰

---

## ğŸš€ æ›´å¥½çš„æ–¹æ¡ˆå»ºè®®

### æœ€ä¼˜æ–¹æ¡ˆï¼šä¸‰å±‚è·¯ç”±ç­–ç•¥

```python
class SmartModelRouter:
    """æ™ºèƒ½æ¨¡å‹è·¯ç”±å™¨"""
    
    async def route_request(self, question, context, history):
        # 1. åˆ†æé—®é¢˜å¤æ‚åº¦
        complexity = self.analyze_complexity(question)
        
        # 2. åˆ†æä¸Šä¸‹æ–‡é•¿åº¦
        context_length = len(context)
        
        # 3. åˆ†æä»»åŠ¡ç±»å‹
        task_type = self.classify_task(question)
        
        # 4. æ™ºèƒ½è·¯ç”±
        if task_type == "summary" and context_length > 2000:
            model = "qwen-max"  # é•¿æ–‡æ€»ç»“
        
        elif complexity < 0.3:  # ç®€å•é—®ç­”ï¼ˆ50%ï¼‰
            model = "qwen-turbo"  # å¿«é€Ÿå“åº”
        
        elif complexity < 0.7:  # ä¸­ç­‰éš¾åº¦ï¼ˆ30%ï¼‰
            model = "qwen-plus"  # å¹³è¡¡æ€§ä»·æ¯”
        
        else:  # å¤æ‚æ¨ç†ï¼ˆ20%ï¼‰
            model = "deepseek"  # å‡†ç¡®å¯é 
        
        return model
    
    def analyze_complexity(self, question):
        """åˆ†æé—®é¢˜å¤æ‚åº¦"""
        # ç®€å•è§„åˆ™ï¼š
        complexity_score = 0.0
        
        # 1. é—®é¢˜é•¿åº¦
        if len(question) > 50:
            complexity_score += 0.2
        
        # 2. æ˜¯å¦åŒ…å«å¤šä¸ªé—®é¢˜
        question_marks = question.count('ï¼Ÿ') + question.count('?')
        if question_marks > 1:
            complexity_score += 0.3
        
        # 3. æ˜¯å¦åŒ…å«é€»è¾‘è¯
        logic_words = ['å¦‚æœ', 'é‚£ä¹ˆ', 'ä¸ºä»€ä¹ˆ', 'æ€ä¹ˆåŠ']
        if any(word in question for word in logic_words):
            complexity_score += 0.3
        
        # 4. æ˜¯å¦éœ€è¦æ¨ç†
        reasoning_words = ['å¯¹æ¯”', 'åˆ†æ', 'è¯„ä¼°', 'å»ºè®®']
        if any(word in question for word in reasoning_words):
            complexity_score += 0.2
        
        return min(complexity_score, 1.0)
```

**æˆæœ¬ä¼˜åŒ–æ•ˆæœ**ï¼š
```
åŸæ–¹æ¡ˆï¼ˆå…¨ç”¨DeepSeekï¼‰: Â¥78/æœˆ
ä¼˜åŒ–æ–¹æ¡ˆï¼ˆæ™ºèƒ½è·¯ç”±ï¼‰: Â¥49/æœˆ
èŠ‚çœ: 37%
```

---

## ğŸ’¡ æœ€ç»ˆå»ºè®®

### æ¨èé…ç½®ï¼ˆæŒ‰ä¼˜å…ˆçº§ï¼‰

#### ğŸ¥‡ ç¬¬ä¸€æ¨èï¼šQwen-turbo + DeepSeekæ··åˆ

**é…ç½®**ï¼š
```yaml
ai_gateway:
  primary:
    provider: "qwen"
    model: "qwen-turbo"
    use_for: ["simple_qa", "quick_response"]
  
  fallback:
    provider: "deepseek"
    model: "deepseek-chat"
    use_for: ["complex_reasoning", "critical_qa"]
  
  routing:
    enable_smart_routing: true
    complexity_threshold: 0.7
```

**ç†ç”±**ï¼š
- âœ… æˆæœ¬æœ€ä½ï¼ˆÂ¥44/æœˆï¼‰
- âœ… é€Ÿåº¦æœ€å¿«ï¼ˆ80%é—®é¢˜<1ç§’ï¼‰
- âœ… è´¨é‡æœ‰ä¿éšœï¼ˆå¤æ‚é—®é¢˜ç”¨DeepSeekï¼‰
- âœ… å®¹é”™æ€§å¼ºï¼ˆä¸»å¤‡åˆ‡æ¢ï¼‰

**é€‚ç”¨**ï¼š**æ‰€æœ‰åœºæ™¯ï¼Œæœ€ä½³æ€§ä»·æ¯”**

---

#### ğŸ¥ˆ ç¬¬äºŒæ¨èï¼šQwen-pluså•ä¸€æ–¹æ¡ˆ

**é…ç½®**ï¼š
```yaml
ai_gateway:
  primary:
    provider: "qwen"
    model: "qwen-plus"
```

**ç†ç”±**ï¼š
- âœ… æ€§ä»·æ¯”é«˜ï¼ˆÂ¥57.6/æœˆï¼‰
- âœ… èƒ½åŠ›å‡è¡¡ï¼ˆ90åˆ†ï¼‰
- âœ… éƒ¨ç½²ç®€å•
- âœ… é€Ÿåº¦å¿«ï¼ˆ1.0ç§’ï¼‰

**é€‚ç”¨**ï¼šä¸æƒ³å¤æ‚é…ç½®ï¼Œè¿½æ±‚å¹³è¡¡

---

#### ğŸ¥‰ ç¬¬ä¸‰æ¨èï¼šDeepSeekå•ä¸€æ–¹æ¡ˆ

**é…ç½®**ï¼š
```yaml
ai_gateway:
  primary:
    provider: "deepseek"
    model: "deepseek-chat"
```

**ç†ç”±**ï¼š
- âœ… æœ€å‡†ç¡®ï¼ˆ98åˆ†ï¼‰
- âœ… å¹»è§‰æœ€å°‘
- âœ… ç¨³å®šå¯é 
- âš ï¸ ç¨æ…¢ï¼ˆ1.5-2ç§’ï¼‰
- âš ï¸ æˆæœ¬ç¨é«˜ï¼ˆÂ¥78/æœˆï¼‰

**é€‚ç”¨**ï¼šè¿½æ±‚æè‡´å‡†ç¡®æ€§

---

## ğŸ“‹ å¯¹æ¯”æ€»ç»“è¡¨

### å¿«é€Ÿå†³ç­–è¡¨

| æ‚¨çš„ä¼˜å…ˆçº§ | æ¨èæ–¹æ¡ˆ | æˆæœ¬/æœˆ | ä¼˜åŠ¿ |
|-----------|---------|---------|------|
| **æˆæœ¬ä¼˜å…ˆ** | Qwen-turbo | Â¥28.8 | æœ€ä¾¿å®œ |
| **æ€§ä»·æ¯”ä¼˜å…ˆ** | Qwen-turbo+DeepSeek | Â¥44.4 | é€Ÿåº¦+è´¨é‡+æˆæœ¬ â­ |
| **å¹³è¡¡** | Qwen-plus | Â¥57.6 | ç®€å•å¯é  |
| **è´¨é‡ä¼˜å…ˆ** | DeepSeek | Â¥78 | æœ€å‡†ç¡® |
| **æè‡´ä¼˜åŒ–** | æ™ºèƒ½è·¯ç”± | Â¥49 | æŒ‰åœºæ™¯é€‰æ‹© â­ |

### ç‰¹å®šåœºæ™¯æ¨è

| åœºæ™¯ | æ¨èæ¨¡å‹ | ç†ç”± |
|------|---------|------|
| **ç®€å•äº§å“å’¨è¯¢** | Qwen-turbo | å¿«+ä¾¿å®œ |
| **å¤æ‚æ•…éšœæ’æŸ¥** | DeepSeek | å‡†ç¡®+é€»è¾‘å¼º |
| **é•¿æ–‡æ¡£æ€»ç»“** | Qwen-max | æ€»ç»“èƒ½åŠ›æœ€å¼º |
| **å¤šæ¨¡æ€ï¼ˆå›¾ç‰‡ï¼‰** | Qwen-max | æ”¯æŒå¤šæ¨¡æ€ |
| **7x24å®¢æœ** | Qwen-turbo+DeepSeek | æˆæœ¬+è´¨é‡å¹³è¡¡ |

---

## ğŸ’» å®ç°ä»£ç 

### æ™ºèƒ½è·¯ç”±é…ç½®

```python
# modules/ai_gateway/smart_router.py

class SmartModelRouter:
    """æ™ºèƒ½æ¨¡å‹è·¯ç”±å™¨"""
    
    def __init__(self):
        self.models = {
            'qwen-turbo': {
                'provider': 'qwen',
                'model': 'qwen-turbo',
                'cost_per_1k': 0.0012,
                'speed': 'fast',
                'best_for': ['simple_qa', 'quick_response']
            },
            'qwen-plus': {
                'provider': 'qwen',
                'model': 'qwen-plus',
                'cost_per_1k': 0.0024,
                'speed': 'medium',
                'best_for': ['general_qa', 'summary']
            },
            'qwen-max': {
                'provider': 'qwen',
                'model': 'qwen-max',
                'cost_per_1k': 0.0048,
                'speed': 'medium',
                'best_for': ['long_summary', 'multimodal']
            },
            'deepseek': {
                'provider': 'deepseek',
                'model': 'deepseek-chat',
                'cost_per_1k': 0.0026,
                'speed': 'slow',
                'best_for': ['complex_reasoning', 'critical_qa']
            }
        }
    
    async def route(self, question, context, metadata=None):
        """è·¯ç”±åˆ°æœ€ä½³æ¨¡å‹"""
        # åˆ†æä»»åŠ¡
        task_type = self._classify_task(question)
        complexity = self._analyze_complexity(question)
        context_length = len(context) if context else 0
        
        # è·¯ç”±å†³ç­–
        if task_type == "summary" and context_length > 2000:
            return "qwen-max"
        
        elif complexity < 0.3:
            return "qwen-turbo"
        
        elif complexity < 0.7:
            return "qwen-plus"
        
        else:
            return "deepseek"
    
    def _classify_task(self, question):
        """åˆ†ç±»ä»»åŠ¡ç±»å‹"""
        if 'æ€»ç»“' in question or 'å½’çº³' in question:
            return "summary"
        elif 'å¯¹æ¯”' in question or 'åˆ†æ' in question:
            return "analysis"
        else:
            return "qa"
    
    def _analyze_complexity(self, question):
        """åˆ†æå¤æ‚åº¦"""
        score = 0.0
        
        # é—®é¢˜é•¿åº¦
        if len(question) > 50:
            score += 0.2
        
        # å¤šä¸ªé—®é¢˜
        if question.count('ï¼Ÿ') > 1:
            score += 0.3
        
        # é€»è¾‘è¯
        if any(w in question for w in ['å¦‚æœ', 'ä¸ºä»€ä¹ˆ', 'æ€ä¹ˆåŠ']):
            score += 0.3
        
        # æ¨ç†è¯
        if any(w in question for w in ['å¯¹æ¯”', 'åˆ†æ', 'å»ºè®®']):
            score += 0.2
        
        return min(score, 1.0)
```

### æ›´æ–°AIç½‘å…³

```python
# modules/ai_gateway/gateway.py

from .smart_router import SmartModelRouter

class AIGateway:
    """å¢å¼ºçš„AIç½‘å…³"""
    
    def __init__(self, enable_smart_routing=True):
        self.enable_smart_routing = enable_smart_routing
        
        if enable_smart_routing:
            self.router = SmartModelRouter()
        
        # åˆå§‹åŒ–æ‰€æœ‰å¯ç”¨æä¾›å•†
        self.providers = {
            'qwen-turbo': self._create_provider('qwen', 'qwen-turbo'),
            'qwen-plus': self._create_provider('qwen', 'qwen-plus'),
            'qwen-max': self._create_provider('qwen', 'qwen-max'),
            'deepseek': self._create_provider('deepseek', 'deepseek-chat')
        }
    
    async def generate(self, question, context=None):
        """ç”Ÿæˆå›ç­”ï¼ˆæ™ºèƒ½è·¯ç”±ï¼‰"""
        # é€‰æ‹©æœ€ä½³æ¨¡å‹
        if self.enable_smart_routing:
            model_key = await self.router.route(question, context)
        else:
            model_key = 'qwen-turbo'  # é»˜è®¤
        
        # è°ƒç”¨é€‰å®šçš„æ¨¡å‹
        provider = self.providers[model_key]
        response = provider.generate(...)
        
        # å¤±è´¥æ—¶é™çº§
        if response.error and model_key != 'deepseek':
            # é™çº§åˆ°DeepSeek
            fallback_provider = self.providers['deepseek']
            response = fallback_provider.generate(...)
        
        return response
```

---

## ğŸ¯ æœ€ç»ˆå»ºè®®

### ç«‹å³è¡ŒåŠ¨æ–¹æ¡ˆï¼ˆæ¨èï¼‰â­â­â­â­â­

**é…ç½®**ï¼š
```bash
# ç¯å¢ƒå˜é‡
export QWEN_API_KEY="your-qwen-api-key"
export QWEN_MODEL="qwen-turbo"  # ä¸»åŠ›æ¨¡å‹
export DEEPSEEK_API_KEY="your-deepseek-api-key"
export DEEPSEEK_MODEL="deepseek-chat"  # å¤‡ç”¨æ¨¡å‹
export ENABLE_SMART_ROUTING="true"
```

**æˆæœ¬ä¼°ç®—**ï¼ˆæ¯å¤©1000æ¬¡é—®ç­”ï¼‰ï¼š
- Qwen-turboï¼ˆ80%ï¼‰: Â¥23/æœˆ
- DeepSeekï¼ˆ20%ï¼‰: Â¥16/æœˆ
- **æ€»è®¡**: Â¥39/æœˆ

**å¯¹æ¯”**ï¼š
- å…¨ç”¨DeepSeek: Â¥78/æœˆï¼ˆèŠ‚çœ50%ï¼‰
- å…¨ç”¨Qwen-plus: Â¥57.6/æœˆï¼ˆèŠ‚çœ32%ï¼‰

**ä¼˜åŠ¿**ï¼š
- âœ… æˆæœ¬ä½ï¼ˆÂ¥39/æœˆï¼‰
- âœ… é€Ÿåº¦å¿«ï¼ˆ80%<1ç§’ï¼‰
- âœ… è´¨é‡é«˜ï¼ˆå¤æ‚é—®é¢˜ç”¨DeepSeekï¼‰
- âœ… çµæ´»ï¼ˆå¯æŒ‰éœ€è°ƒæ•´ï¼‰

---

## ğŸ“‹ æ€»ç»“

### â“ Qwen3 vs DeepSeekï¼Œé€‰å“ªä¸ªï¼Ÿ

**ç­”æ¡ˆ**: **æ··åˆä½¿ç”¨æœ€ä¼˜** â­â­â­â­â­

**æ¨èé…ç½®**ï¼š
```
ä¸»åŠ›: Qwen-turboï¼ˆ80%åœºæ™¯ï¼‰- å¿«é€Ÿ+ä¾¿å®œ
å¤‡ç”¨: DeepSeekï¼ˆ20%åœºæ™¯ï¼‰- å‡†ç¡®+å¯é 
```

**æˆæœ¬**: Â¥39-44/æœˆ  
**æ•ˆæœ**: é€Ÿåº¦+è´¨é‡+æˆæœ¬ä¸‰ä¼˜

### å„æ¨¡å‹é€‚ç”¨åœºæ™¯

| æ¨¡å‹ | æœ€é€‚åˆ | ä¸é€‚åˆ |
|------|--------|--------|
| **Qwen-turbo** | ç®€å•é—®ç­”ã€äº§å“å’¨è¯¢ | å¤æ‚æ¨ç† |
| **Qwen-plus** | é€šç”¨åœºæ™¯ã€å¹³è¡¡éœ€æ±‚ | æè‡´æ€§èƒ½ |
| **Qwen-max** | é•¿æ–‡æ€»ç»“ã€å¤šæ¨¡æ€ | æˆæœ¬æ•æ„Ÿ |
| **DeepSeek** | å¤æ‚æ¨ç†ã€å…³é”®é—®ç­” | é€Ÿåº¦è¦æ±‚é«˜ |

### ç«‹å³å®æ–½

```bash
# 1. é…ç½®ç¯å¢ƒå˜é‡
export QWEN_API_KEY="your-key"
export QWEN_MODEL="qwen-turbo"
export DEEPSEEK_API_KEY="your-key"
export ENABLE_SMART_ROUTING="true"

# 2. æµ‹è¯•
python test_smart_routing.py
```

---

**ğŸ‰ æœ€ä½³æ–¹æ¡ˆï¼šQwen-turboä¸ºä¸» + DeepSeekå¤‡ç”¨ + æ™ºèƒ½è·¯ç”±ï¼**

**æˆæœ¬**: Â¥39/æœˆï¼Œæ¯”å•ç”¨DeepSeekèŠ‚çœ50%  
**æ€§èƒ½**: 80%é—®é¢˜<1ç§’å“åº”  
**è´¨é‡**: å¤æ‚é—®é¢˜å‡†ç¡®ç‡98%  

**è¿™æ˜¯æœ€ä¼˜è§£ï¼** ğŸš€
