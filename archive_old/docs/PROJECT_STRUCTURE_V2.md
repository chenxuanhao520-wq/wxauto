# ğŸ“ é¡¹ç›®ç»“æ„è¯´æ˜ v2.0

**C/Såˆ†ç¦»æ¶æ„ç‰ˆæœ¬**

---

## ğŸ—ï¸ æ€»ä½“æ¶æ„

```
wxauto-1/
â”œâ”€â”€ ğŸ“± client/              # Windowsè½»å®¢æˆ·ç«¯
â”œâ”€â”€ ğŸ–¥ï¸  server/              # äº‘æœåŠ¡å™¨ç«¯
â”œâ”€â”€ ğŸ“¦ modules/             # å…±äº«æ¨¡å—ï¼ˆæœåŠ¡å™¨ä½¿ç”¨ï¼‰
â”œâ”€â”€ ğŸ§  core/                # æ ¸å¿ƒåŠŸèƒ½
â”œâ”€â”€ ğŸŒ web/                 # Webç®¡ç†ç•Œé¢
â”œâ”€â”€ ğŸ“š docs/                # æ–‡æ¡£
â”œâ”€â”€ ğŸ§ª tests/               # æµ‹è¯•
â””â”€â”€ ğŸ› ï¸  scripts/             # å·¥å…·è„šæœ¬
```

---

## ğŸ“± å®¢æˆ·ç«¯ (client/)

**èŒè´£**: Windowsç«¯UIè‡ªåŠ¨åŒ–ï¼Œèµ„æºå ç”¨~50MB

```
client/
â”œâ”€â”€ agent/                          # å¾®ä¿¡è‡ªåŠ¨åŒ–
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ wx_automation.py           # å¾®ä¿¡UIæ“ä½œå°è£…
â”‚       â€¢ get_new_messages()       # æŠ“å–æ¶ˆæ¯
â”‚       â€¢ send_message()           # å‘é€æ¶ˆæ¯
â”‚       â€¢ get_screenshot()         # æˆªå›¾ï¼ˆé¢„ç•™ï¼‰
â”‚       â€¢ get_status()             # çŠ¶æ€æ£€æŸ¥
â”‚
â”œâ”€â”€ api/                            # æœåŠ¡å™¨é€šä¿¡
â”‚   â””â”€â”€ server_client.py           # HTTPå®¢æˆ·ç«¯
â”‚       â€¢ authenticate()           # JWTè®¤è¯
â”‚       â€¢ report_message()         # ä¸ŠæŠ¥æ¶ˆæ¯
â”‚       â€¢ get_reply()              # è·å–å›å¤
â”‚       â€¢ send_heartbeat()         # å‘é€å¿ƒè·³
â”‚
â”œâ”€â”€ cache/                          # æœ¬åœ°ç¼“å­˜
â”‚   â””â”€â”€ local_cache.py             # AES-256åŠ å¯†ç¼“å­˜
â”‚       â€¢ save_message()           # åŠ å¯†ä¿å­˜
â”‚       â€¢ load_message()           # è§£å¯†è¯»å–
â”‚       â€¢ offline_queueç®¡ç†        # ç¦»çº¿é˜Ÿåˆ—
â”‚
â”œâ”€â”€ monitor/                        # ç›‘æ§
â”‚   â””â”€â”€ heartbeat.py               # å¿ƒè·³æœåŠ¡
â”‚       â€¢ 30ç§’é—´éš”å¿ƒè·³
â”‚       â€¢ çŠ¶æ€è‡ªåŠ¨ä¸ŠæŠ¥
â”‚
â”œâ”€â”€ config/                         # é…ç½®
â”‚   â””â”€â”€ client_config.yaml         # å®¢æˆ·ç«¯é…ç½®æ–‡ä»¶
â”‚
â”œâ”€â”€ __init__.py
â””â”€â”€ main_client.py                 # å®¢æˆ·ç«¯ä¸»ç¨‹åº â­
    â€¢ 296è¡Œ
    â€¢ å®Œæ•´çš„æ¶ˆæ¯å¾ªç¯
    â€¢ ç¦»çº¿é˜Ÿåˆ—å¤„ç†
    â€¢ é”™è¯¯å¤„ç†
```

---

## ğŸ–¥ï¸ æœåŠ¡å™¨ (server/)

**èŒè´£**: æ‰€æœ‰å¤æ‚ä¸šåŠ¡é€»è¾‘ï¼Œå¯å¼¹æ€§æ‰©å±•

```
server/
â”œâ”€â”€ api/                            # REST APIå±‚
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ auth.py                    # è®¤è¯API
â”‚   â”‚   â€¢ POST /auth/login        # å®¢æˆ·ç«¯ç™»å½•
â”‚   â”‚   â€¢ POST /auth/refresh      # Tokenåˆ·æ–°
â”‚   â”‚
â”‚   â”œâ”€â”€ messages.py                # æ¶ˆæ¯API
â”‚   â”‚   â€¢ POST /messages          # æ¥æ”¶æ¶ˆæ¯
â”‚   â”‚   â€¢ GET  /messages/:id/reply # è·å–å›å¤
â”‚   â”‚   â€¢ POST /send              # ä¸»åŠ¨å‘é€
â”‚   â”‚
â”‚   â”œâ”€â”€ heartbeat.py               # å¿ƒè·³API
â”‚   â”‚   â€¢ POST /heartbeat         # æ¥æ”¶å¿ƒè·³
â”‚   â”‚   â€¢ GET  /agents/status     # å®¢æˆ·ç«¯çŠ¶æ€
â”‚   â”‚
â”‚   â””â”€â”€ stats.py                   # ç»Ÿè®¡API
â”‚       â€¢ GET  /stats             # ç³»ç»Ÿç»Ÿè®¡
â”‚       â€¢ GET  /stats/messages    # æ¶ˆæ¯ç»Ÿè®¡
â”‚
â”œâ”€â”€ services/                       # ä¸šåŠ¡æœåŠ¡å±‚
â”‚   â””â”€â”€ message_service.py         # æ¶ˆæ¯å¤„ç†æœåŠ¡ â­
â”‚       â€¢ process_message()        # æ ¸å¿ƒå¤„ç†é€»è¾‘
â”‚       â€¢ _is_duplicate()          # å»é‡
â”‚       â€¢ _identify_customer()     # å®¢æˆ·è¯†åˆ«
â”‚       â€¢ _check_rules()           # è§„åˆ™å¼•æ“
â”‚       â€¢ _retrieve_knowledge()    # çŸ¥è¯†åº“æ£€ç´¢
â”‚       â€¢ _generate_reply()        # AIç”Ÿæˆ
â”‚
â”œâ”€â”€ models/                         # æ•°æ®æ¨¡å‹ï¼ˆé¢„ç•™ï¼‰
â”œâ”€â”€ utils/                          # å·¥å…·å‡½æ•°ï¼ˆé¢„ç•™ï¼‰
â”œâ”€â”€ __init__.py
â””â”€â”€ main_server.py                 # FastAPIä¸»ç¨‹åº â­
    â€¢ 107è¡Œ
    â€¢ ç”Ÿå‘½å‘¨æœŸç®¡ç†
    â€¢ è·¯ç”±æ³¨å†Œ
    â€¢ CORSé…ç½®
```

---

## ğŸ“¦ å…±äº«æ¨¡å— (modules/)

**æœåŠ¡å™¨ç«¯ä½¿ç”¨çš„ä¸šåŠ¡æ¨¡å—**

```
modules/
â”œâ”€â”€ ai_gateway/                     # AIç½‘å…³
â”‚   â”œâ”€â”€ gateway.py                 # ç»Ÿä¸€ç½‘å…³
â”‚   â””â”€â”€ providers/                 # 7ä¸ªæä¾›å•†
â”‚       â”œâ”€â”€ openai_provider.py
â”‚       â”œâ”€â”€ claude_provider.py
â”‚       â”œâ”€â”€ deepseek_provider.py
â”‚       â”œâ”€â”€ qwen_provider.py
â”‚       â”œâ”€â”€ moonshot_provider.py
â”‚       â”œâ”€â”€ gemini_provider.py
â”‚       â””â”€â”€ ernie_provider.py
â”‚
â”œâ”€â”€ rag/                            # çŸ¥è¯†åº“æ£€ç´¢
â”‚   â””â”€â”€ retriever.py               # å‘é‡æ£€ç´¢
â”‚
â”œâ”€â”€ storage/                        # æ•°æ®å­˜å‚¨
â”‚   â””â”€â”€ db.py                      # æ•°æ®åº“æ“ä½œ
â”‚
â”œâ”€â”€ erp_sync/                       # ERPåŒæ­¥
â”‚   â”œâ”€â”€ erp_client.py              # ERPå®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ sync_service.py            # åŒæ­¥æœåŠ¡
â”‚   â””â”€â”€ rule_engine.py             # è§„åˆ™å¼•æ“
â”‚
â”œâ”€â”€ conversation_context/           # å¯¹è¯ä¸Šä¸‹æ–‡
â”‚   â”œâ”€â”€ context_manager.py         # ä¸Šä¸‹æ–‡ç®¡ç†
â”‚   â””â”€â”€ session_lifecycle.py       # ä¼šè¯ç”Ÿå‘½å‘¨æœŸ
â”‚
â”œâ”€â”€ learning_loop/                  # è‡ªåŠ¨å­¦ä¹ 
â”‚   â””â”€â”€ knowledge_learner.py       # çŸ¥è¯†å­¦ä¹ 
â”‚
â”œâ”€â”€ adapters/                       # é€‚é…å™¨ï¼ˆå®¢æˆ·ç«¯ç”¨ï¼‰
â”‚   â””â”€â”€ wxauto_adapter.py          # å¾®ä¿¡é€‚é…å™¨
â”‚
â””â”€â”€ integrations/                   # å¤–éƒ¨é›†æˆ
    â”œâ”€â”€ feishu_bitable.py          # é£ä¹¦å¤šç»´è¡¨æ ¼
    â””â”€â”€ dingtalk_bitable.py        # é’‰é’‰å¤šç»´è¡¨æ ¼
```

---

## ğŸ§  æ ¸å¿ƒåŠŸèƒ½ (core/)

**æœåŠ¡å™¨ç«¯æ ¸å¿ƒä¸šåŠ¡**

```
core/
â”œâ”€â”€ customer_manager.py             # å®¢æˆ·ç®¡ç†
â”‚   â€¢ å®¢æˆ·åˆ†çº§ï¼ˆç™½/ç°/é»‘åå•ï¼‰
â”‚   â€¢ çŠ¶æ€æœºï¼ˆæ–°å®¢â†’æ½œå®¢â†’æˆäº¤â†’å¤è´­ï¼‰
â”‚
â”œâ”€â”€ conversation_tracker.py         # å¯¹è¯è¿½è¸ª
â”‚   â€¢ å®Œæ•´å¯¹è¯ä¸²ä¿å­˜
â”‚   â€¢ è´¨é‡è¯„ä¼°
â”‚   â€¢ ç»“æœæ ‡è®°
â”‚
â”œâ”€â”€ system_monitor.py               # ç³»ç»Ÿç›‘æ§ â­
â”‚   â€¢ ç³»ç»Ÿèµ„æºç›‘æ§
â”‚   â€¢ æ€§èƒ½è¿½è¸ª
â”‚   â€¢ å‘Šè­¦ç®¡ç†
â”‚
â”œâ”€â”€ error_handler.py                # é”™è¯¯å¤„ç† â­
â”‚   â€¢ ç»Ÿä¸€å¼‚å¸¸å¤„ç†
â”‚   â€¢ é‡è¯•æœºåˆ¶
â”‚   â€¢ é”™è¯¯ç»Ÿè®¡
â”‚
â”œâ”€â”€ performance_optimizer.py        # æ€§èƒ½ä¼˜åŒ– â­
â”‚   â€¢ ç¼“å­˜ç®¡ç†
â”‚   â€¢ æ•°æ®åº“ä¼˜åŒ–
â”‚
â”œâ”€â”€ config_loader.py                # é…ç½®åŠ è½½
â””â”€â”€ system_integrator.py            # ç³»ç»Ÿé›†æˆ
```

---

## ğŸŒ Webç•Œé¢ (web/)

**Webç®¡ç†åå°**

```
web/
â”œâ”€â”€ web_frontend.py                 # Flaskåº”ç”¨
â”œâ”€â”€ customer_hub_api.py             # å®¢æˆ·ä¸­å°API
â””â”€â”€ templates/                      # HTMLæ¨¡æ¿
    â”œâ”€â”€ index.html                 # é¦–é¡µ
    â”œâ”€â”€ monitor.html               # ç›‘æ§å¤§ç›˜
    â”œâ”€â”€ customers.html             # å®¢æˆ·ç®¡ç†
    â””â”€â”€ logs.html                  # æ—¥å¿—æŸ¥çœ‹
```

---

## ğŸ“š æ–‡æ¡£ (docs/)

```
docs/
â”œâ”€â”€ README.md                       # æ–‡æ¡£ç´¢å¼• â­
â”‚
â”œâ”€â”€ guides/                         # ä½¿ç”¨æŒ‡å—
â”‚   â”œâ”€â”€ å¿«é€Ÿå¼€å§‹.md
â”‚   â”œâ”€â”€ INSTALLATION.md
â”‚   â”œâ”€â”€ LLM_PROVIDERS.md
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ features/                       # åŠŸèƒ½æ–‡æ¡£
â”‚   â”œâ”€â”€ æ™ºèƒ½å¯¹è¯ä¸Šä¸‹æ–‡ç®¡ç†æ–¹æ¡ˆ.md
â”‚   â”œâ”€â”€ ä¼šè¯è¶…æ—¶ç®¡ç†æ–¹æ¡ˆå¯¹æ¯”.md
â”‚   â”œâ”€â”€ KNOWLEDGE_BASE_SOLUTION.md
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ integrations/                   # é›†æˆæ–‡æ¡£
â”‚   â”œâ”€â”€ ERPåŒæ­¥ç³»ç»ŸREADME.md
â”‚   â”œâ”€â”€ è¡¨æ ¼åŒæ­¥ä½¿ç”¨è¯´æ˜.md
â”‚   â””â”€â”€ ...
â”‚
â””â”€â”€ erp_api/                        # ERP APIæ–‡æ¡£
    â”œâ”€â”€ æ™ºé‚¦ERP_APIå®Œæ•´ç´¢å¼•.md
    â””â”€â”€ api_by_category/           # åˆ†ç±»APIæ–‡æ¡£
```

---

## ğŸ§ª æµ‹è¯• (tests/)

```
tests/
â”œâ”€â”€ test_system_enhancements.py     # ç³»ç»Ÿå¢å¼ºæµ‹è¯• â­
â”‚   â€¢ ç›‘æ§æµ‹è¯•
â”‚   â€¢ ç¼“å­˜æµ‹è¯•
â”‚   â€¢ é”™è¯¯å¤„ç†æµ‹è¯•
â”‚
â”œâ”€â”€ test_db.py                      # æ•°æ®åº“æµ‹è¯•
â”œâ”€â”€ test_rag_routing.py             # çŸ¥è¯†åº“æµ‹è¯•
â”œâ”€â”€ test_customer_system.py         # å®¢æˆ·ç®¡ç†æµ‹è¯•
â””â”€â”€ ...

æ€»è®¡: 52ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œ96%é€šè¿‡ç‡
```

---

## ğŸ› ï¸ è„šæœ¬ (scripts/)

```
scripts/
â”œâ”€â”€ check_db.py                     # æ•°æ®åº“æ£€æŸ¥
â”œâ”€â”€ kb_manager.py                   # çŸ¥è¯†åº“ç®¡ç†
â”œâ”€â”€ upload_documents.py             # æ–‡æ¡£ä¸Šä¼ 
â”œâ”€â”€ start_erp_sync.py               # ERPåŒæ­¥å¯åŠ¨
â””â”€â”€ ...
```

---

## ğŸ“„ é…ç½®æ–‡ä»¶

```
â”œâ”€â”€ config.yaml                     # ä¸»é…ç½®æ–‡ä»¶ï¼ˆæœåŠ¡å™¨ï¼‰
â”œâ”€â”€ client/config/client_config.yaml # å®¢æˆ·ç«¯é…ç½® â­
â”œâ”€â”€ requirements.txt                # åŸæœ‰ä¾èµ–
â”œâ”€â”€ requirements_client.txt         # å®¢æˆ·ç«¯ä¾èµ– â­
â”œâ”€â”€ requirements_server.txt         # æœåŠ¡å™¨ä¾èµ– â­
â”œâ”€â”€ docker-compose.yml              # Dockerç¼–æ’ â­
â””â”€â”€ Dockerfile.server               # æœåŠ¡å™¨é•œåƒ â­
```

---

## ğŸš€ å¯åŠ¨è„šæœ¬

```
â”œâ”€â”€ start_server.sh/.bat            # å¯åŠ¨æœåŠ¡å™¨ â­
â”œâ”€â”€ start_client.sh/.bat            # å¯åŠ¨å®¢æˆ·ç«¯ â­
â”œâ”€â”€ start.bat                       # æ—§ç‰ˆå¯åŠ¨ï¼ˆå…¼å®¹ï¼‰
â””â”€â”€ å¯åŠ¨Webç•Œé¢.bat                  # Webç•Œé¢å¯åŠ¨
```

---

## ğŸ“Š ä»£ç ç»Ÿè®¡

| æ¨¡å— | æ–‡ä»¶æ•° | ä»£ç è¡Œæ•° | è¯´æ˜ |
|------|--------|---------|------|
| **client/** | 7ä¸ª | ~900è¡Œ | è½»é‡çº§å®¢æˆ·ç«¯ â­ |
| **server/** | 7ä¸ª | ~650è¡Œ | FastAPIæœåŠ¡å™¨ â­ |
| **modules/** | 60+ä¸ª | ~8000è¡Œ | ä¸šåŠ¡æ¨¡å— |
| **core/** | 10ä¸ª | ~2500è¡Œ | æ ¸å¿ƒåŠŸèƒ½ |
| **web/** | 10ä¸ª | ~1000è¡Œ | Webç•Œé¢ |
| **tests/** | 10ä¸ª | ~800è¡Œ | æµ‹è¯•ç”¨ä¾‹ |
| **æ€»è®¡** | ~100ä¸ª | ~14,000è¡Œ | - |

---

## ğŸ¯ æ¶æ„ç‰¹ç‚¹

### å®¢æˆ·ç«¯ï¼ˆè½»ï¼‰

- âœ… åªåšUIè‡ªåŠ¨åŒ–
- âœ… å†…å­˜å ç”¨~50MB
- âœ… å¯åŠ¨é€Ÿåº¦å¿«
- âœ… æ”¯æŒä½é…PC

### æœåŠ¡å™¨ï¼ˆé‡ï¼‰

- âœ… æ‰€æœ‰å¤æ‚è®¡ç®—
- âœ… é›†ä¸­æ•°æ®ç®¡ç†
- âœ… å¯æ°´å¹³æ‰©å±•
- âœ… å¾®æœåŠ¡å‹å¥½

### é€šä¿¡

- âœ… REST APIï¼ˆåŒæ­¥ï¼‰
- âœ… WebSocketï¼ˆå®æ—¶ï¼Œå¯é€‰ï¼‰
- âœ… JWTè®¤è¯
- âœ… AES-256åŠ å¯†

---

## ğŸ“– ç›¸å…³æ–‡æ¡£

- [README.md](README.md) - é¡¹ç›®æ€»è§ˆ
- [START_HERE.md](START_HERE.md) - å¿«é€Ÿå¼€å§‹
- [ğŸ—ï¸æ¶æ„è®¾è®¡-C-Såˆ†ç¦»æ–¹æ¡ˆ.md](ğŸ—ï¸æ¶æ„è®¾è®¡-C-Såˆ†ç¦»æ–¹æ¡ˆ.md) - æ¶æ„è¯¦è§£
- [ğŸ“˜C-Sæ¶æ„éƒ¨ç½²æŒ‡å—.md](ğŸ“˜C-Sæ¶æ„éƒ¨ç½²æŒ‡å—.md) - éƒ¨ç½²æ‰‹å†Œ
- [docs/README.md](docs/README.md) - å®Œæ•´æ–‡æ¡£ç´¢å¼•

---

**æ›´æ–°æ—¥æœŸ**: 2025-01-19  
**ç‰ˆæœ¬**: v2.0.0  
**æ¶æ„**: Client-Server

