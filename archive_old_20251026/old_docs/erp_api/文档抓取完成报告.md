# 智邦国际 ERP API 文档抓取完成报告

**抓取时间**: 2025-10-18 12:58  
**状态**: ✅ 成功完成  

---

## 📊 抓取成果

### 文档清单

| 文件名 | 说明 | 格式 | API数量 |
|--------|------|------|---------|
| `智邦国际ERP_API完整文档.md` | 完整的API文档（结构化） | Markdown | 219个 |
| `智邦国际ERP_API列表.json` | API端点列表（扁平化） | JSON | 219个 |
| `智邦国际ERP_API列表.csv` | API端点列表（Excel可用） | CSV | 219个 |
| `智邦国际ERP_OpenAPI文档.html` | 原始HTML文档 | HTML | - |

---

## 🎯 API 覆盖范围

### 12 大模块

1. **鉴权接口** (2个)
   - 登录系统
   - 退出系统

2. **组织架构** (9个)
   - 部门管理 (4个)
   - 账号管理 (5个)

3. **销售栏目** (65个)
   - 客户管理 (19个)
   - 客户联系人对接 (4个)
   - 项目管理 (4个)
   - 合同管理 (16个)
   - 售后服务 (3个)
   - 售后维修 (3个)

4. **采购栏目** (6个)
   - 采购管理 (3个)
   - 供应商管理 (2个)

5. **库存栏目** (31个)
   - 库存查看 (9个)
   - 入库管理 (7个)
   - 出库管理 (6个)
   - 发货管理 (3个)
   - 产品管理 (9个)

6. **生产栏目** (40个)
   - 物料清单管理 (2个)
   - 设备管理 (2个)
   - 工序管理 (8个)
   - 工艺路线管理 (4个)
   - 派工管理 (2个)
   - 领料管理 (2个)
   - 生产质检管理 (10个)
   - 物料登记管理 (2个)
   - 工序汇报管理 (8个)

7. **财务栏目** (58个)
   - 现金银行 (2个)
   - 收款开票管理 (4个)
   - 付款收票管理 (2个)
   - 费用管理 (50个)

8. **办公栏目** (32个)
   - 公司公告 (3个)
   - 工作互动 (5个)
   - 日程管理 (18个)
   - 通讯录关联 (3个)

9. **研发** (10个)
   - 物料清单 (5个)
   - 物料替代 (4个)

10. **人资栏目** (1个)
    - 考勤管理 (1个)

---

## 🔑 核心 API（与客户中台集成相关）

### 客户管理 API

```
GET  /webapi/v3/ov1/salesmanage/custom/list         # 获取客户列表
POST /webapi/v3/ov1/salesmanage/custom/add          # 添加或修改客户
GET  /webapi/v3/ov1/salesmanage/custom/add?edit=1   # 获取客户详情
POST /webapi/v3/sales/customer/add                  # 客户添加
POST /webapi/v3/sales/customer/edit                 # 客户修改
```

### 联系人 API

```
GET  /webapi/v3/ov1/salesmanage/person/list         # 获取联系人列表
POST /webapi/v3/ov1/salesmanage/person/add          # 添加或修改联系人
GET  /webapi/v3/ov1/salesmanage/person/add?edit=1   # 获取联系人详情
```

### 合同 API

```
GET  /webapi/v3/ov1/salesmanage/contract/billlist   # 获取合同列表
POST /webapi/v3/ov1/salesmanage/contract/add        # 添加或修改合同
GET  /webapi/v3/sales/contract/detail                # 合同详情
POST /webapi/v3/sale/contract/add                    # 合同添加
```

### 产品 API

```
GET  /webapi/v3/ov1/salesmanage/product/billlist    # 获取产品列表
GET  /webapi/v3/ov1/salesmanage/product/billService # 获取产品详情
POST /webapi/v3/store/product/add                    # 产品添加
POST /webapi/v3/store/product/edit                   # 产品修改
```

---

## 🔗 集成建议

### 阶段一：基础集成（优先级高）

1. **认证接口**
   - `/webapi/v3/ov1/login` - 登录获取 Token

2. **客户同步**
   - Customer Hub → ERP: 建档后同步客户信息
   - ERP → Customer Hub: 定时同步客户更新

3. **合同关联**
   - 微信会话 → 客户中台 → ERP 合同

### 阶段二：深度集成（优先级中）

4. **订单管理**
   - 报价单生成
   - 合同状态同步

5. **产品信息**
   - 产品库存查询
   - 价格信息获取

### 阶段三：全面集成（优先级低）

6. **售后服务**
   - 售后工单同步
   - 维修记录关联

7. **财务数据**
   - 收款状态查询
   - 发票信息同步

---

## 💻 使用示例

### 示例 1：登录 ERP

```python
import requests

# 登录
response = requests.post(
    'http://ls1.jmt.ink:46088/webapi/v3/ov1/login',
    json={
        'username': 'your_username',
        'password': 'your_password'
    }
)

token = response.json().get('token')
```

### 示例 2：获取客户列表

```python
# 获取客户列表
response = requests.post(
    'http://ls1.jmt.ink:46088/webapi/v3/ov1/salesmanage/custom/list',
    headers={'Authorization': f'Bearer {token}'},
    json={
        'pageIndex': 1,
        'pageSize': 20
    }
)

customers = response.json().get('data')
```

### 示例 3：添加客户

```python
# 添加客户
response = requests.post(
    'http://ls1.jmt.ink:46088/webapi/v3/sales/customer/add',
    headers={'Authorization': f'Bearer {token}'},
    json={
        'name': '张三公司',
        'contact': '张三',
        'phone': '13800138000',
        'address': '重庆市渝中区'
    }
)
```

---

## 📋 下一步行动

### 立即可做

1. ✅ **文档已就绪** - 所有API文档已保存到 `docs/erp_api/` 目录
2. ✅ **API清单完整** - 219个端点，涵盖所有业务模块
3. ✅ **多种格式** - Markdown/JSON/CSV 三种格式，方便查阅

### 待开发

1. **创建 ERP 客户端类**
   ```python
   # 位置: customer_hub/erp_integration.py
   class ZhibangERPClient:
       def __init__(self, base_url, username, password):
           ...
       
       def login(self):
           ...
       
       def get_customer(self, customer_id):
           ...
       
       def sync_customer_from_hub(self, contact):
           """将 Customer Hub 的联系人同步到 ERP"""
           ...
   ```

2. **实现数据映射**
   ```python
   # Customer Hub Contact -> ERP Customer
   def map_contact_to_erp_customer(contact: Contact) -> dict:
       return {
           'name': contact.remark or contact.wx_id,
           'k_code': contact.k_code,
           'source': 'wechat',
           'confidence': contact.confidence,
           ...
       }
   ```

3. **配置定时同步**
   - 每小时同步客户状态
   - 每日同步合同信息
   - 实时同步工单

---

## 🔐 安全提醒

1. **不要提交敏感信息**
   - ERP 登录凭证写入 `.env` 文件
   - 在 `.gitignore` 中排除

2. **使用专用账号**
   - 创建集成专用账号
   - 分配最小权限

3. **启用日志审计**
   - 记录所有 API 调用
   - 监控异常访问

---

## 📞 技术支持

- **官方文档**: http://ls1.jmt.ink:46088/sysn/view/OpenApi/help.ashx
- **系统登录**: http://ls1.jmt.ink:46088/
- **文档位置**: `docs/erp_api/`

---

**报告生成时间**: 2025-10-18  
**总计 API 数量**: 219 个  
**覆盖模块**: 12 个  
**状态**: ✅ 文档完整，可开始集成开发

