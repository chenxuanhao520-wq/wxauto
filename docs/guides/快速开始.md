# 🚀 快速开始指南

**微信客服中台 v2.0 - C/S架构版**

---

## 🎯 概述

本指南将帮助您在**15分钟内**完成系统的安装、配置和启动。

### 系统要求

**服务器端:**
- Python 3.9+
- 4GB+ 内存
- Linux/Mac/Windows均可

**客户端:**
- Windows 10/11
- Python 3.9+
- 已安装PC版微信

---

## 📋 步骤一: 克隆项目

```bash
git clone https://github.com/chenxuanhao520-wq/wxauto.git
cd wxauto
```

---

## 🖥️ 步骤二: 启动服务器

### 方式A: 本地运行（开发/测试）

```bash
# 1. 安装依赖
pip install -r requirements_server.txt

# 2. 配置环境变量（可选）
export DEEPSEEK_API_KEY=sk-your-key  # AI模型密钥

# 3. 启动服务器
./start_server.sh        # Mac/Linux
start_server.bat         # Windows

# 或直接运行
python server/main_server.py
```

服务器将在 `http://localhost:8000` 启动

**验证服务器:**

```bash
# 访问健康检查
curl http://localhost:8000/api/v1/health

# 应返回:
{
  "status": "healthy",
  "service": "wx-customer-service",
  "version": "2.0.0"
}
```

**查看API文档:**

浏览器访问: http://localhost:8000/docs

### 方式B: Docker运行（生产环境）

```bash
# 一键启动（服务器 + PostgreSQL + Redis）
docker-compose up -d

# 查看日志
docker-compose logs -f server

# 停止服务
docker-compose down
```

---

## 💻 步骤三: 配置客户端

### 1. 编辑配置文件

编辑 `client/config/client_config.yaml`:

```yaml
# 服务器配置
server:
  url: "http://localhost:8000"      # 服务器地址（本地测试）
  # url: "http://your-server-ip:8000"  # 生产环境

# 客户端配置
client:
  agent_id: "agent_001"              # 客户端唯一ID
  api_key: "your-api-key-here"       # API密钥
  name: "客服001号"

# 微信配置
wechat:
  auto_start: true
  check_interval: 1                  # 每秒检查一次新消息

# 缓存配置
cache:
  enabled: true                      # 启用本地缓存
  encryption: true                   # 启用AES-256加密
  cleanup_days: 7                    # 保留7天缓存

# 心跳配置
heartbeat:
  enabled: true
  interval: 30                       # 每30秒发送心跳
```

### 2. 配置API Key

在服务器端的 `server/api/auth.py` 中配置允许的客户端：

```python
valid_agents = {
    "agent_001": "your-api-key-here",
    "agent_002": "another-api-key"
}
```

**生产环境应该从数据库或环境变量读取！**

---

## 📱 步骤四: 启动客户端

```bash
# 1. 安装依赖
pip install -r requirements_client.txt

# 2. 启动客户端
./start_client.sh        # Mac/Linux
start_client.bat         # Windows

# 或直接运行
python client/main_client.py
```

**客户端启动流程:**

```
[1/5] 服务器健康检查...
✅ 服务器健康

[2/5] 客户端认证...
✅ 认证成功

[3/5] 启动心跳监控...
✅ 心跳监控已启动

[4/5] 检查微信状态...
✅ 微信在线

[5/5] 启动消息监听...
✅ 客户端运行中...
```

---

## 🧪 步骤五: 测试运行

### 1. 发送测试消息

在微信中向机器人发送消息：

```
你好
```

### 2. 观察日志

**客户端日志** (`logs/client.log`):

```
📨 收到消息: 用户: 你好
💬 已回复: 您好！有什么可以帮您的吗？
```

**服务器日志** (`logs/server.log`):

```
📨 收到消息: agent=agent_001, msg_id=...
✅ 消息处理完成: action=reply
```

### 3. 检查数据

服务器会将所有数据保存到数据库，可以通过Web界面查看。

---

## 🎨 步骤六: 启用Web管理界面（可选）

```bash
# 启动Web界面
python web/web_frontend.py

# 访问
http://localhost:5000
```

Web界面功能：
- 📊 实时监控大盘
- 👥 客户管理
- 💬 对话记录
- 📈 统计报表

---

## 🔧 常见配置

### 配置AI模型

编辑服务器环境变量:

```bash
# OpenAI GPT
export OPENAI_API_KEY=sk-your-key

# DeepSeek（推荐，性价比高）
export DEEPSEEK_API_KEY=sk-your-key

# Claude
export ANTHROPIC_API_KEY=sk-your-key

# 重启服务器生效
```

### 配置知识库

```bash
# 上传文档到知识库
python scripts/upload_documents.py --dir /path/to/your/docs

# 支持格式: PDF, Word, Excel, Markdown, TXT
```

### 配置ERP同步

编辑 `config.yaml`:

```yaml
erp_sync:
  enabled: true
  base_url: "http://your-erp-server"
  username: "your-username"
  password: "your-password"
```

---

## 🎯 验证清单

启动完成后，确认以下项目：

- [ ] 服务器健康检查返回正常
- [ ] 客户端认证成功
- [ ] 心跳正常发送
- [ ] 微信消息能正常抓取
- [ ] AI能正常生成回复
- [ ] 数据库正常保存
- [ ] Web界面能访问

全部✅后，系统就可以正常工作了！

---

## 🚀 下一步

### 新手

1. 📖 阅读功能文档: [features/](../features/)
2. 🎮 测试各种功能
3. 💬 加入用户群交流

### 开发者

1. 📖 阅读架构文档: [🏗️架构设计-C-S分离方案.md](../../🏗️架构设计-C-S分离方案.md)
2. 🔍 查看API文档: http://localhost:8000/docs
3. 💻 修改代码并测试

### 运维

1. 📊 配置监控: Prometheus + Grafana
2. 🔐 配置HTTPS
3. 🌐 配置域名和负载均衡

---

## ❓ 遇到问题？

### 查看日志

```bash
# 客户端日志
tail -f logs/client.log

# 服务器日志
tail -f logs/server.log
```

### 常见问题

1. **服务器无法启动**
   - 检查端口8000是否被占用
   - 检查Python版本 >= 3.9
   - 查看错误日志

2. **客户端无法连接**
   - 确认服务器已启动
   - 检查配置文件中的URL
   - 测试网络连接

3. **AI不回复**
   - 确认配置了API Key
   - 检查API Key是否有效
   - 查看服务器日志错误

### 获取帮助

- 📖 查看完整文档索引
- 🐛 提交GitHub Issue
- 💬 联系技术支持

---

## 🎉 成功！

如果您看到这里，恭喜您已经成功启动了微信客服中台系统！

**开始享受AI客服带来的效率提升吧！** 🚀

---

**文档版本**: v2.0  
**最后更新**: 2025-01-19
