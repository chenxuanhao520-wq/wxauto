# ğŸ“˜ å¾®ä¿¡å®¢æœä¸­å°ç³»ç»Ÿ - å®Œæ•´æ¢³ç†æ–‡æ¡£

**ç‰ˆæœ¬**: v2.0  
**æ›´æ–°æ—¥æœŸ**: 2025-10-19  
**æ–‡æ¡£ç±»å‹**: å…¨æ ˆå·¥ç¨‹å¸ˆç³»ç»Ÿæ¢³ç†  

---

## ğŸ¯ ç³»ç»Ÿæ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ª**ä¼ä¸šçº§å¾®ä¿¡å®¢æœä¸­å°ç³»ç»Ÿ**ï¼Œé›†æˆäº†ä»¥ä¸‹æ ¸å¿ƒèƒ½åŠ›ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              å¾®ä¿¡å®¢æœä¸­å°ç³»ç»Ÿæ¶æ„                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚ å¾®ä¿¡ç›‘å¬  â”‚ â†’  â”‚ AIå¤„ç†   â”‚ â†’  â”‚ æ¶ˆæ¯å‘é€  â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚       â†“               â†“               â†“                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚ ä¸Šä¸‹æ–‡    â”‚    â”‚ çŸ¥è¯†åº“   â”‚    â”‚ ERPåŒæ­¥  â”‚              â”‚
â”‚  â”‚ ç®¡ç†     â”‚    â”‚ RAGæ£€ç´¢  â”‚    â”‚ æ•°æ®     â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚       â†“               â†“               â†“                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚        å¤šç»´è¡¨æ ¼ï¼ˆé£ä¹¦/é’‰é’‰ï¼‰            â”‚                â”‚
â”‚  â”‚   å¯¹è¯åˆ†æ | çŸ¥è¯†å­¦ä¹  | å®¢æˆ·ç”»åƒ        â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“‚ ç³»ç»Ÿæ¶æ„

### äº”å±‚æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. åº”ç”¨å±‚ (Application Layer)                           â”‚
â”‚    main.py - ä¸»ç¨‹åºå…¥å£                                  â”‚
â”‚    web/ - Webç®¡ç†ç•Œé¢                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. æ ¸å¿ƒä¸šåŠ¡å±‚ (Core Business Layer)                     â”‚
â”‚    core/ - å¯¹è¯è¿½è¸ªã€å®¢æˆ·ç®¡ç†ã€æ™ºèƒ½åˆ†æ                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. åŠŸèƒ½æ¨¡å—å±‚ (Feature Modules Layer)                   â”‚
â”‚    modules/ - 11ä¸ªç‹¬ç«‹åŠŸèƒ½æ¨¡å—                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. åŸºç¡€è®¾æ–½å±‚ (Infrastructure Layer)                    â”‚
â”‚    storage/ - æ•°æ®åº“                                    â”‚
â”‚    integrations/ - ç¬¬ä¸‰æ–¹é›†æˆ                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. å·¥å…·å±‚ (Tools Layer)                                 â”‚
â”‚    scripts/ - è„šæœ¬å·¥å…·                                  â”‚
â”‚    tests/ - æµ‹è¯•                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ§© æ¨¡å—è¯¦è§£

### 1. core/ - æ ¸å¿ƒä¸šåŠ¡æ¨¡å— (7ä¸ªæ–‡ä»¶)

#### core/config_loader.py â­ NEW
```python
"""ç»Ÿä¸€é…ç½®åŠ è½½å™¨"""

from core import get_config

# åŠ è½½é…ç½®
config = get_config()
print(config.llm.primary)        # ä¸»LLMæ¨¡å‹
print(config.context.idle_timeout)  # ç©ºé—²è¶…æ—¶
print(config.erp.base_url)       # ERPåœ°å€
```

**åŠŸèƒ½**:
- âœ… ç»Ÿä¸€é…ç½®ç®¡ç†
- âœ… ç¯å¢ƒå˜é‡è¦†ç›–
- âœ… ç±»å‹å®‰å…¨è®¿é—®
- âœ… çƒ­é‡è½½æ”¯æŒ

---

#### core/system_integrator.py â­ NEW
```python
"""ç³»ç»Ÿé›†æˆå™¨ - ç»Ÿä¸€åˆå§‹åŒ–æ‰€æœ‰æ¨¡å—"""

from core import WxAutoSystem

# ä¸€è¡Œä»£ç åˆå§‹åŒ–æ•´ä¸ªç³»ç»Ÿ
system = WxAutoSystem()
system.initialize()

# å¤„ç†æ¶ˆæ¯
result = system.process_message(
    contact_id="wx_user_123",
    message="ä½ ä»¬çš„å……ç”µæ¡©æ”¯æŒå¤šå°‘åŠŸç‡ï¼Ÿ"
)

print(result['response'])  # AIå›å¤
```

**åŠŸèƒ½**:
- âœ… ç»Ÿä¸€åˆå§‹åŒ–
- âœ… ä¾èµ–æ³¨å…¥
- âœ… ç”Ÿå‘½å‘¨æœŸç®¡ç†
- âœ… ç»Ÿè®¡ç›‘æ§

---

#### core/conversation_tracker.py
```python
"""å¯¹è¯è¿½è¸ªå™¨ - è¿½è¸ªå¯¹è¯æ•ˆæœå’Œè´¨é‡"""

# æ ‡è®°å¯¹è¯ç»“æœ
tracker.mark_outcome(session_key, ConversationOutcome(
    outcome='solved',           # solved/unsolved/transferred
    reason='AIæˆåŠŸè§£å†³é—®é¢˜',
    resolved_by='ai',          # ai/human/self
    satisfaction_score=5,
    tags=['å”®å', 'AIè§£å†³']
))

# è·å–å¯¹è¯æ‘˜è¦
summary = tracker.get_conversation_summary(session_key)
```

**åŠŸèƒ½**:
- âœ… å¯¹è¯æ•ˆæœè¿½è¸ª
- âœ… å®Œæ•´å¯¹è¯ä¿å­˜
- âœ… è‡ªåŠ¨è´¨é‡è¯„ä¼°
- âœ… æ ‡ç­¾ç®¡ç†

---

#### core/customer_manager.py
```python
"""å®¢æˆ·ç®¡ç†å™¨ - ç®¡ç†å®¢æˆ·åˆ†ç»„å’Œç»‘å®š"""

# ç»‘å®šå®¢æˆ·
customer_manager.bind_customer("group_id:user_id", "å®¢æˆ·åç§°")

# è·å–å®¢æˆ·åˆ—è¡¨
customers = customer_manager.get_all_customers()
```

---

#### core/smart_analyzer.py
```python
"""æ™ºèƒ½åˆ†æå™¨ - åˆ†æå¯¹è¯æ„å›¾å’Œæƒ…æ„Ÿ"""

# åˆ†ææ¶ˆæ¯
analysis = smart_analyzer.analyze("ä½ ä»¬çš„äº§å“æ€ä¹ˆæ ·ï¼Ÿ")
print(analysis['intent'])       # å’¨è¯¢
print(analysis['sentiment'])    # ç§¯æ
```

---

#### core/ops_tools.py
```python
"""è¿ç»´å·¥å…· - ç³»ç»Ÿå¥åº·æ£€æŸ¥å’Œç»´æŠ¤"""

from core import health_check, generate_performance_report

# å¥åº·æ£€æŸ¥
status = health_check()

# æ€§èƒ½æŠ¥å‘Š
report = generate_performance_report()
```

---

#### core/sync_manager.py
```python
"""åŒæ­¥ç®¡ç†å™¨ - ç®¡ç†å¤šç»´è¡¨æ ¼åŒæ­¥"""

# åŒæ­¥åˆ°é£ä¹¦
sync_manager.sync_to_feishu(days=7)
```

---

### 2. modules/ - åŠŸèƒ½æ¨¡å—å±‚ (11ä¸ªæ¨¡å—)

#### modules/ai_gateway/ - AIç½‘å…³ (7ä¸ªå¤§æ¨¡å‹)

```python
"""AIç½‘å…³ - ç»Ÿä¸€ç®¡ç†å¤šä¸ªå¤§æ¨¡å‹"""

from modules.ai_gateway.gateway import AIGateway

# åˆå§‹åŒ–ï¼ˆè‡ªåŠ¨è¯»å–é…ç½®ï¼‰
gateway = AIGateway(
    primary_model="openai:gpt-4o-mini",
    fallback_model="deepseek:chat"
)

# ç”Ÿæˆå›å¤
response = gateway.generate(
    prompt="ä½ æ˜¯ä¸“ä¸šçš„å®¢æœ...",
    user_message="å……ç”µæ¡©æ”¯æŒå¤šå°‘åŠŸç‡ï¼Ÿ",
    temperature=0.7,
    max_tokens=500
)
```

**æ”¯æŒçš„å¤§æ¨¡å‹**:
1. âœ… OpenAI (gpt-4o-mini)
2. âœ… DeepSeek (deepseek-chat) - æœ€ä¾¿å®œ
3. âœ… Claude (claude-3-5-sonnet)
4. âœ… é€šä¹‰åƒé—® (qwen-max)
5. âœ… æ–‡å¿ƒä¸€è¨€ (ernie-4.0)
6. âœ… Gemini (gemini-1.5-flash)
7. âœ… Moonshot (moonshot-v1-8k)

---

#### modules/conversation_context/ - å¯¹è¯ä¸Šä¸‹æ–‡ç®¡ç† â­ NEW

```python
"""æ™ºèƒ½å¯¹è¯ä¸Šä¸‹æ–‡ç®¡ç† - é™ä½75%+ Tokenæ¶ˆè€—"""

from modules.conversation_context import (
    ContextManager,
    SessionLifecycleManager,
    DialogueType
)

# 1. ä¸Šä¸‹æ–‡ç®¡ç†å™¨
context_mgr = ContextManager(max_age_minutes=30)

# æ·»åŠ æ¶ˆæ¯
context_mgr.add_message("user_123", "ä½ å¥½", role='user')

# è·å–ç²¾ç®€ä¸Šä¸‹æ–‡ï¼ˆè‡ªåŠ¨ç­›é€‰ï¼‰
context = context_mgr.get_relevant_context(
    "user_123",
    current_type=DialogueType.CONSULTATION,
    max_tokens=2000  # ä¸¥æ ¼æ§åˆ¶
)

# 2. ä¼šè¯ç”Ÿå‘½å‘¨æœŸç®¡ç†å™¨
session_mgr = SessionLifecycleManager(
    config=SessionConfig(
        idle_timeout=5,      # 5åˆ†é’Ÿç©ºé—²
        dormant_timeout=15,  # 15åˆ†é’Ÿä¼‘çœ 
        expire_timeout=30    # 30åˆ†é’Ÿè¿‡æœŸ
    ),
    message_sender=send_wechat_message
)

session_mgr.start_monitoring()  # å¯åŠ¨åå°ç›‘æ§
```

**æ ¸å¿ƒåŠŸèƒ½**:
- âœ… æ™ºèƒ½å¯¹è¯åˆ†ç±»ï¼ˆé—²èŠ/å’¨è¯¢/ä¸šåŠ¡ï¼‰
- âœ… åŠ¨æ€ä¸Šä¸‹æ–‡çª—å£ï¼ˆ1-5è½®ï¼‰
- âœ… ä¸»é¢˜åˆ‡æ¢æ£€æµ‹
- âœ… å®ä½“è‡ªåŠ¨æå–
- âœ… Tokenæ¶ˆè€—é™ä½75%+

---

#### modules/erp_sync/ - ERPåŒæ­¥ â­

```python
"""ERPåŒæ­¥ - ä¸æ™ºé‚¦å›½é™…ERPç³»ç»Ÿé›†æˆ"""

from modules.erp_sync.zhibang_client_enhanced import ZhibangERPClient

# åˆå§‹åŒ–å®¢æˆ·ç«¯
client = ZhibangERPClient(
    base_url='http://ls1.jmt.ink:46088',
    username='your_username',
    password='your_password'
)

# åŒæ­¥å®¢æˆ·åˆ°ERP
result = client.sync_customer_from_wechat(
    contact={'id': 123, 'name': 'å¼ ä¸‰', 'phone': '13800138000'},
    thread={'score': 85}
)

# æ·»åŠ è·Ÿè¿›è®°å½•
client.add_followup_record(
    customer_id=customer_ord,
    template_id=106,  # è°ˆçš„å¾ˆå¥½
    content='å®¢æˆ·å¾ˆæ„Ÿå…´è¶£'
)
```

**æ ¸å¿ƒåŠŸèƒ½**:
- âœ… å®¢æˆ·ä¿¡æ¯åŒæ­¥
- âœ… è·Ÿè¿›è®°å½•åŒæ­¥
- âœ… è‡ªåŠ¨åˆ†é…å®¢æˆ·
- âœ… åŒå‘æ•°æ®åŒæ­¥
- âœ… å†²çªè‡ªåŠ¨è§£å†³

---

#### modules/customer_hub/ - å®¢æˆ·ä¸­å°

```python
"""å®¢æˆ·ä¸­å° - å®¢æˆ·åˆ†çº§å’ŒçŠ¶æ€ç®¡ç†"""

from modules.customer_hub.service import CustomerHubService

service = CustomerHubService(db)

# å¤„ç†å…¥ç«™æ¶ˆæ¯
service.ingest_message(InboundMessage(
    party=Party.THEM,
    contact_id="user_123",
    content="ä½ å¥½",
    timestamp=datetime.now()
))

# è·å–å¾…å¤„ç†çº¿ç¨‹
threads = service.get_unknown_threads()

# æå‡ä¸ºæ­£å¼å®¢æˆ·
service.promote_contact("user_123", "å¼ ä¸‰", "æŸæŸç§‘æŠ€")
```

**æ ¸å¿ƒåŠŸèƒ½**:
- âœ… ä¸‰çº§åˆ†ç±»ï¼ˆæœªçŸ¥/ç°åå•/ç™½åå•ï¼‰
- âœ… çŠ¶æ€æœºç®¡ç†
- âœ… è‡ªåŠ¨è¯„åˆ†
- âœ… SLAç®¡ç†

---

#### modules/kb_service/ - çŸ¥è¯†åº“æœåŠ¡

```python
"""çŸ¥è¯†åº“æœåŠ¡ - RAGæ£€ç´¢å’Œæ–‡æ¡£ç®¡ç†"""

from modules.kb_service.document_processor import DocumentProcessor

processor = DocumentProcessor()

# ä¸Šä¼ æ–‡æ¡£
processor.process_document('manual.pdf')

# æœç´¢
results = retriever.search("å……ç”µæ¡©æ”¯æŒå¤šå°‘åŠŸç‡", top_k=3)
```

**æ”¯æŒæ ¼å¼**:
- âœ… PDFï¼ˆæ–‡å­—+OCRï¼‰
- âœ… DOC/DOCX
- âœ… å›¾ç‰‡ï¼ˆOCRï¼‰
- âœ… Markdown

---

#### modules/integrations/ - ç¬¬ä¸‰æ–¹é›†æˆ

```python
"""ç¬¬ä¸‰æ–¹é›†æˆ - é£ä¹¦/é’‰é’‰å¤šç»´è¡¨æ ¼"""

from modules.integrations.feishu_bitable import FeishuBitable

# åŒæ­¥å¯¹è¯åˆ°é£ä¹¦
feishu = FeishuBitable()
count = feishu.sync_conversations_from_database(
    db_path='data/data.db',
    since=datetime.now() - timedelta(days=7)
)
```

---

#### modules/adaptive_learning/ - è‡ªé€‚åº”å­¦ä¹ 

```python
"""è‡ªé€‚åº”å­¦ä¹  - ä»å†å²å¯¹è¯ä¸­å­¦ä¹ """

from modules.adaptive_learning import UserProfiler, ContinuousLearner

# ç”¨æˆ·ç”»åƒ
profiler = UserProfiler(db)
profile = profiler.get_user_profile("user_123")

# æŒç»­å­¦ä¹ 
learner = ContinuousLearner(db)
learner.learn_from_conversation(session_key)
```

---

### 3. scripts/ - å·¥å…·è„šæœ¬å±‚

```
scripts/
â”œâ”€â”€ quickstart.py              # å¿«é€Ÿå¯åŠ¨å’Œåˆå§‹åŒ–
â”œâ”€â”€ import_wechat_history.py   # å¯¼å…¥å†å²å¯¹è¯
â”œâ”€â”€ upload_documents.py         # ä¸Šä¼ çŸ¥è¯†åº“æ–‡æ¡£
â”œâ”€â”€ sync_to_bitable.py          # åŒæ­¥åˆ°å¤šç»´è¡¨æ ¼
â”œâ”€â”€ start_erp_sync.py           # å¯åŠ¨ERPåŒæ­¥
â”œâ”€â”€ kb_manager.py               # çŸ¥è¯†åº“ç®¡ç†
â”œâ”€â”€ check_db.py                 # æ•°æ®åº“æ£€æŸ¥
â””â”€â”€ utils/
    â””â”€â”€ parse_complete_erp_api.py  # ERP APIè§£æ
```

---

### 4. web/ - Webç•Œé¢å±‚

```
web/
â”œâ”€â”€ web_frontend.py            # Flaskä¸»ç¨‹åº
â”œâ”€â”€ customer_hub_api.py        # å®¢æˆ·ä¸­å°REST API
â””â”€â”€ templates/                 # HTMLæ¨¡æ¿
    â”œâ”€â”€ index.html            # ä¸»é¡µ
    â”œâ”€â”€ config.html           # é…ç½®ç®¡ç†
    â”œâ”€â”€ customers.html        # å®¢æˆ·åˆ—è¡¨
    â””â”€â”€ monitor.html          # ç³»ç»Ÿç›‘æ§
```

---

## ğŸ”§ å®Œæ•´ä½¿ç”¨æµç¨‹

### æ–¹å¼1: ä½¿ç”¨ç³»ç»Ÿé›†æˆå™¨ï¼ˆæ¨èï¼‰â­

```python
#!/usr/bin/env python3
"""
å®Œæ•´ä½¿ç”¨ç¤ºä¾‹ - ç³»ç»Ÿé›†æˆå™¨æ–¹å¼
"""

from core import WxAutoSystem

# 1. åˆ›å»ºç³»ç»Ÿå®ä¾‹
system = WxAutoSystem(config_path="config.yaml")

# 2. åˆå§‹åŒ–æ‰€æœ‰æ¨¡å—
system.initialize()

# 3. å¤„ç†æ¶ˆæ¯ï¼ˆä¸€è¡Œä»£ç æå®šï¼‰
result = system.process_message(
    contact_id="wx_user_123",
    message="ä½ ä»¬çš„å……ç”µæ¡©æ”¯æŒå¤šå°‘åŠŸç‡ï¼Ÿ"
)

# ç³»ç»Ÿè‡ªåŠ¨å®Œæˆï¼š
# âœ… å¯¹è¯åˆ†ç±»ï¼ˆå’¨è¯¢ç±»-äº§å“ï¼‰
# âœ… ä¸Šä¸‹æ–‡ç®¡ç†ï¼ˆä¿ç•™5è½®ï¼‰
# âœ… çŸ¥è¯†åº“æ£€ç´¢
# âœ… LLMç”Ÿæˆå›å¤
# âœ… ä¼šè¯çŠ¶æ€æ›´æ–°
# âœ… å¯¹è¯è¿½è¸ªè®°å½•

print(f"AIå›å¤: {result['response']}")
print(f"å¯¹è¯ç±»å‹: {result['type']}")
print(f"ä¸Šä¸‹æ–‡è½®æ•°: {result['context_length']}")
print(f"å¤„ç†æ—¶é—´: {result['processing_time']}ç§’")

# 4. è·å–ç³»ç»Ÿç»Ÿè®¡
stats = system.get_statistics()
print(f"ç³»ç»ŸçŠ¶æ€: {stats}")

# 5. ä¼˜é›…å…³é—­
system.shutdown()
```

---

### æ–¹å¼2: æ‰‹åŠ¨ç»„è£…æ¨¡å—

```python
#!/usr/bin/env python3
"""
æ‰‹åŠ¨ç»„è£…æ¨¡å—ç¤ºä¾‹ - æ›´çµæ´»çš„æ§åˆ¶
"""

from core import get_config, ConversationTracker
from modules.storage.db import Database
from modules.ai_gateway.gateway import AIGateway
from modules.conversation_context import ContextManager
from modules.rag.retriever import Retriever

# 1. åŠ è½½é…ç½®
config = get_config()

# 2. åˆå§‹åŒ–æ•°æ®åº“
db = Database(config.database_path)

# 3. åˆå§‹åŒ–AIç½‘å…³
ai_gateway = AIGateway(
    primary_model=config.llm.primary,
    fallback_model=config.llm.fallback
)

# 4. åˆå§‹åŒ–çŸ¥è¯†åº“
retriever = Retriever(
    db=db,
    vector_store_path=config.knowledge_base.vector_store_path
)

# 5. åˆå§‹åŒ–ä¸Šä¸‹æ–‡ç®¡ç†
context_mgr = ContextManager(
    max_age_minutes=config.context.max_age_minutes
)

# 6. åˆå§‹åŒ–å¯¹è¯è¿½è¸ª
conv_tracker = ConversationTracker(db)

# 7. å¤„ç†æ¶ˆæ¯
def handle_message(contact_id, message):
    # æ·»åŠ åˆ°ä¸Šä¸‹æ–‡
    context_mgr.add_message(contact_id, message, role='user')
    
    # è·å–ä¸Šä¸‹æ–‡
    context = context_mgr.get_relevant_context(contact_id)
    
    # æ£€ç´¢çŸ¥è¯†åº“
    kb_results = retriever.search(message, top_k=3)
    
    # æ„å»ºprompt
    prompt = f"é—®é¢˜: {message}\nçŸ¥è¯†åº“: {kb_results}"
    
    # LLMç”Ÿæˆ
    response = ai_gateway.generate(prompt)
    
    # ä¿å­˜å›å¤
    context_mgr.add_message(contact_id, response, role='assistant')
    
    return response
```

---

## ğŸ“Š æ ¸å¿ƒåŠŸèƒ½æµç¨‹

### æµç¨‹1: æ¶ˆæ¯å¤„ç†å®Œæ•´æµç¨‹

```
ç”¨æˆ·æ¶ˆæ¯
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. æ¶ˆæ¯æ¥æ”¶               â”‚
â”‚    - å¾®ä¿¡é€‚é…å™¨ç›‘å¬        â”‚
â”‚    - å»é‡ã€é¢‘æ§           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. ä¸Šä¸‹æ–‡ç®¡ç†             â”‚
â”‚    - å¿«é€Ÿåˆ†ç±»ï¼ˆé—²èŠ/å’¨è¯¢ï¼‰ â”‚
â”‚    - ä¸»é¢˜æ£€æµ‹             â”‚
â”‚    - æ™ºèƒ½çª—å£ç­›é€‰         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. çŸ¥è¯†åº“æ£€ç´¢             â”‚
â”‚    - å‘é‡æ£€ç´¢             â”‚
â”‚    - ç›¸å…³åº¦è¯„åˆ†           â”‚
â”‚    - å–Top3              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. LLMç”Ÿæˆå›å¤           â”‚
â”‚    - æ„å»ºprompt          â”‚
â”‚    - è°ƒç”¨ä¸»æ¨¡å‹           â”‚
â”‚    - å¤±è´¥é™çº§å¤‡ç”¨         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. å›å¤å‘é€               â”‚
â”‚    - æ‹ŸäººåŒ–å»¶è¿Ÿ           â”‚
â”‚    - é¢‘ç‡æ§åˆ¶             â”‚
â”‚    - è®°å½•æ—¥å¿—             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. ä¼šè¯ç®¡ç†               â”‚
â”‚    - æ›´æ–°æ´»åŠ¨æ—¶é—´         â”‚
â”‚    - çŠ¶æ€è½¬æ¢             â”‚
â”‚    - è¶…æ—¶æ£€æµ‹             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 7. æ•°æ®è®°å½•               â”‚
â”‚    - ä¿å­˜åˆ°æ•°æ®åº“         â”‚
â”‚    - å¯¹è¯è¿½è¸ª             â”‚
â”‚    - åŒæ­¥å¤šç»´è¡¨æ ¼         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### æµç¨‹2: ä¼šè¯ç»“æŸå­¦ä¹ é—­ç¯

```
ä¼šè¯ç»“æŸ
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. æ™ºèƒ½ç»“æŸåˆ¤å®š           â”‚
â”‚    - è¶…æ—¶30åˆ†é’Ÿ           â”‚
â”‚    - ç”¨æˆ·æ˜ç¡®("è°¢è°¢")     â”‚
â”‚    - ä¸šåŠ¡å®Œæˆ             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. ä¿¡æ¯æå–               â”‚
â”‚    - å®ä½“æå–             â”‚
â”‚    - çŸ¥è¯†ç‚¹æå–           â”‚
â”‚    - è´¨é‡è¯„åˆ†             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. å¤šç»´è¡¨æ ¼åŒæ­¥           â”‚
â”‚    - å¯¹è¯çº§è§†å›¾           â”‚
â”‚    - çŸ¥è¯†ç‚¹è§†å›¾           â”‚
â”‚    - å®¢æˆ·ç”»åƒè§†å›¾         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. çŸ¥è¯†åº“è‡ªåŠ¨æ›´æ–°         â”‚
â”‚    - é«˜è´¨é‡Q&Aè‡ªåŠ¨å…¥åº“    â”‚
â”‚    - ä¸­ç­‰è´¨é‡å¾…å®¡æ ¸       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. LLMå­¦ä¹ åé¦ˆ           â”‚
â”‚    - ç”Ÿæˆè®­ç»ƒæ•°æ®         â”‚
â”‚    - Promptä¼˜åŒ–å»ºè®®       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### æµç¨‹3: ERPåŒæ­¥æµç¨‹

```
å¾®ä¿¡å®¢æˆ·
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. å‡†å…¥æ£€æŸ¥               â”‚
â”‚    - æ‰‹æœºå·éªŒè¯           â”‚
â”‚    - è¯„åˆ†>=60            â”‚
â”‚    - ä¿¡æ¯å®Œæ•´æ€§           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. åŒæ­¥åˆ°ERP             â”‚
â”‚    - åˆ†é…æ–°å®¢æˆ·ID         â”‚
â”‚    - æ·»åŠ å®¢æˆ·ä¿¡æ¯         â”‚
â”‚    - æ ‡è®°æ¥æº(ly=171)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. è·Ÿè¿›è®°å½•åŒæ­¥           â”‚
â”‚    - åŒæ­¥æ²Ÿé€šè®°å½•         â”‚
â”‚    - è‡ªåŠ¨åˆ†é…é”€å”®         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. åŒå‘æ•°æ®åŒæ­¥           â”‚
â”‚    - å®šæ—¶æ‹‰å–ERPæ•°æ®      â”‚
â”‚    - å˜æ›´æ£€æµ‹             â”‚
â”‚    - å†²çªè§£å†³             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ æ ¸å¿ƒåˆ›æ–°ç‚¹

### 1. æ™ºèƒ½ä¸Šä¸‹æ–‡ç®¡ç†

**é—®é¢˜**: å®Œæ•´å¯¹è¯å†å²æµªè´¹token  
**æ–¹æ¡ˆ**: æ ¹æ®å¯¹è¯ç±»å‹ä½¿ç”¨ä¸åŒçª—å£å¤§å°

```python
é—²èŠç±»: ä¿ç•™1è½®   (èŠ‚çœ90% token)
å’¨è¯¢ç±»: ä¿ç•™5è½®   (èŠ‚çœ65% token)
ä¸šåŠ¡ç±»: ä¿ç•™3è½®   (èŠ‚çœ60% token)

å¹³å‡èŠ‚çœ: 75%+ token
```

---

### 2. ä¼šè¯ç”Ÿå‘½å‘¨æœŸç®¡ç†

**é—®é¢˜**: ä¸çŸ¥é“ä½•æ—¶ç»“æŸä¼šè¯  
**æ–¹æ¡ˆ**: å¤šçº§çŠ¶æ€+æ™ºèƒ½åˆ¤å®š

```python
æ´»è·ƒ â†’ ç©ºé—²(5åˆ†é’Ÿ) â†’ ä¼‘çœ (15åˆ†é’Ÿ) â†’ è¿‡æœŸ(30åˆ†é’Ÿ)
         â†“              â†“               â†“
    æ¸©å’Œæç¤º       åå°æ ‡è®°         æ¸…ç†ä¸Šä¸‹æ–‡
```

---

### 3. å¯¹è¯é—­ç¯å­¦ä¹ 

**é—®é¢˜**: å¯¹è¯æ•°æ®æ²¡æœ‰åˆ©ç”¨  
**æ–¹æ¡ˆ**: è‡ªåŠ¨æå–â†’å…¥åº“â†’åé¦ˆ

```python
å¯¹è¯ç»“æŸ 
  â†’ æå–é«˜è´¨é‡Q&A
  â†’ è´¨é‡è¯„åˆ†>80 â†’ è‡ªåŠ¨å…¥åº“
  â†’ ç”Ÿæˆè®­ç»ƒæ•°æ®
  â†’ æŒç»­ä¼˜åŒ–
```

---

### 4. ERPæ™ºèƒ½åŒæ­¥

**é—®é¢˜**: æ‰‹åŠ¨ç»´æŠ¤ERPæ•°æ®  
**æ–¹æ¡ˆ**: è‡ªåŠ¨åŒæ­¥+è´¨é‡æ§åˆ¶

```python
å¾®ä¿¡å®¢æˆ· 
  â†’ å‡†å…¥æ£€æŸ¥ï¼ˆæ‰‹æœºå·+è¯„åˆ†ï¼‰
  â†’ åŒæ­¥åˆ°ERP
  â†’ è‡ªåŠ¨åˆ†é…é”€å”®
  â†’ åŒå‘æ•°æ®åŒæ­¥
```

---

## ğŸ“‹ é…ç½®ç¤ºä¾‹

### config.yaml å®Œæ•´ç¤ºä¾‹

```yaml
# LLMé…ç½®
llm:
  primary: "deepseek:chat"           # ä¸»æ¨¡å‹ï¼ˆæœ€ä¾¿å®œï¼‰
  fallback: "openai:gpt-4o-mini"     # å¤‡ç”¨ï¼ˆæœ€å¥½ï¼‰
  temperature: 0.7
  max_tokens: 1000

# ä¸Šä¸‹æ–‡ç®¡ç†
context:
  max_age_minutes: 30
  idle_timeout: 5
  dormant_timeout: 15
  expire_timeout: 30
  send_idle_prompt: true
  custom_timeouts:
    é—²èŠç±»:
      idle: 2
      dormant: 5
      expire: 10
    å’¨è¯¢ç±»:
      idle: 5
      dormant: 15
      expire: 30
    ä¸šåŠ¡ç±»:
      idle: 10
      dormant: 20
      expire: 60

# ERPé›†æˆ
erp_integration:
  enabled: true
  base_url: "http://ls1.jmt.ink:46088"
  username: "your_username"
  password: "your_password"
  customer_source_id: 171      # å®¢æˆ·æ¥æºï¼šç½‘ç«™æ³¨å†Œï¼ˆä»£è¡¨å¾®ä¿¡ï¼‰
  customer_category: "å¾®ä¿¡å®¢æˆ·"
  sync:
    enabled: true
    pull_interval_minutes: 60  # æ¯å°æ—¶æ‹‰å–ä¸€æ¬¡
    push_interval_minutes: 30  # æ¯30åˆ†é’Ÿæ¨é€ä¸€æ¬¡

# çŸ¥è¯†åº“
knowledge_base:
  enabled: true
  vector_store_path: "data/vector_store"
  embedding_model: "bge-m3"
  top_k: 3
  score_threshold: 0.6

# å¤šç»´è¡¨æ ¼
multitable:
  enabled: true
  platform: "feishu"           # feishu | dingtalk
  sync_conversations: true     # åŒæ­¥å¯¹è¯çº§åˆ«
  sync_messages: false         # ä¸åŒæ­¥æ¶ˆæ¯çº§åˆ«
  sync_interval_hours: 1       # æ¯å°æ—¶åŒæ­¥

# ç³»ç»Ÿé…ç½®
debug_mode: false
log_level: "INFO"
database_path: "data/data.db"
use_wework: false
humanize_behavior: true
max_requests_per_minute: 20
```

---

## ğŸš€ å¿«é€Ÿå¯åŠ¨

### å®Œæ•´å¯åŠ¨æµç¨‹

```bash
# 1. å®‰è£…ä¾èµ–
pip install -r requirements.txt

# 2. åˆå§‹åŒ–æ•°æ®åº“
python3 scripts/quickstart.py

# 3. é…ç½®å¤§æ¨¡å‹ï¼ˆé€‰ä¸€ä¸ªï¼‰
export DEEPSEEK_API_KEY=sk-xxxxx  # æœ€ä¾¿å®œ
# æˆ–
export OPENAI_API_KEY=sk-xxxxx    # æœ€å¥½

# 4. å¯åŠ¨ç³»ç»Ÿ
python3 main.py

# 5. å¯åŠ¨Webç•Œé¢ï¼ˆå¯é€‰ï¼‰
python3 web/web_frontend.py
```

---

## ğŸ“ˆ ç³»ç»Ÿç›‘æ§

### å…³é”®æŒ‡æ ‡

| æŒ‡æ ‡ | è¯´æ˜ | æŸ¥çœ‹æ–¹å¼ |
|------|------|---------|
| Tokenæ¶ˆè€— | LLMæˆæœ¬ | Webç•Œé¢/monitor.html |
| å“åº”æ—¶é—´ | å¹³å‡æ—¶å»¶ | æ€§èƒ½æŠ¥å‘Š |
| æˆåŠŸç‡ | å›å¤æˆåŠŸç‡ | å¯¹è¯è¿½è¸ª |
| æ»¡æ„åº¦ | ç”¨æˆ·æ»¡æ„åº¦ | å¤šç»´è¡¨æ ¼ |

### æŸ¥çœ‹ç»Ÿè®¡

```python
from core import WxAutoSystem

system = WxAutoSystem()
system.initialize()

# è·å–ç»Ÿè®¡
stats = system.get_statistics()
print(stats)
```

---

## ğŸ” æ•…éšœæ’æŸ¥

### å¸¸è§é—®é¢˜

#### 1. å¯¼å…¥é”™è¯¯

**é”™è¯¯**: `ModuleNotFoundError: No module named 'modules'`

**è§£å†³**:
```python
# åœ¨æ–‡ä»¶å¼€å¤´æ·»åŠ 
import sys
from pathlib import Path
project_root = Path(__file__).parent
sys.path.insert(0, str(project_root / 'modules'))
```

---

#### 2. é…ç½®æœªåŠ è½½

**é”™è¯¯**: `AttributeError: 'SystemConfig' object has no attribute 'llm'`

**è§£å†³**:
```bash
# æ£€æŸ¥config.yamlæ˜¯å¦å­˜åœ¨
ls -la config.yaml

# æ£€æŸ¥é…ç½®æ ¼å¼
python3 -c "from core import get_config; print(get_config())"
```

---

#### 3. ERPè¿æ¥å¤±è´¥

**é”™è¯¯**: `AuthenticationError: ç™»å½•å¤±è´¥`

**è§£å†³**:
```bash
# æ£€æŸ¥é…ç½®
cat config.yaml | grep -A 5 "erp_integration"

# æµ‹è¯•è¿æ¥
python3 -c "
from modules.erp_sync.zhibang_client_enhanced import ZhibangERPClient
client = ZhibangERPClient('http://ls1.jmt.ink:46088', 'user', 'pass')
print('è¿æ¥æˆåŠŸ')
"
```

---

## ğŸ“š æ–‡æ¡£å¯¼èˆª

### æŒ‰è§’è‰²åˆ†ç±»

#### å¼€å‘è€…
- [é¡¹ç›®ç»“æ„è¯´æ˜](PROJECT_STRUCTURE_NEW.md)
- [æ ¸å¿ƒæ¨¡å—æ–‡æ¡£](docs/features/)
- [APIå‚è€ƒ](docs/erp_api/)

#### è¿ç»´äººå‘˜
- [å®‰è£…æŒ‡å—](docs/guides/INSTALLATION.md)
- [éƒ¨ç½²æŒ‡å—](docs/guides/WINDOWS_DEPLOYMENT.md)
- [å‡çº§æŒ‡å—](docs/guides/UPGRADE_GUIDE.md)

#### äº§å“ç»ç†
- [åŠŸèƒ½è¯´æ˜](docs/features/)
- [é›†æˆæ–¹æ¡ˆ](docs/integrations/)
- [ERPå¯¹æ¥](docs/erp_api/å¾®ä¿¡ä¸­å°ERPå¯¹æ¥æŒ‡å—.md)

---

## âœ… ç³»ç»Ÿæ£€æŸ¥æ¸…å•

### æ ¸å¿ƒæ¨¡å—

- [x] core/ - æ ¸å¿ƒä¸šåŠ¡ï¼ˆ7ä¸ªæ–‡ä»¶ï¼‰
  - [x] conversation_tracker.py
  - [x] customer_manager.py
  - [x] smart_analyzer.py
  - [x] ops_tools.py
  - [x] sync_manager.py
  - [x] config_loader.py â­ NEW
  - [x] system_integrator.py â­ NEW
  - [x] __init__.py â­ NEW

### åŠŸèƒ½æ¨¡å—

- [x] modules/ai_gateway/ - AIç½‘å…³
- [x] modules/conversation_context/ - ä¸Šä¸‹æ–‡ç®¡ç†â­
- [x] modules/erp_sync/ - ERPåŒæ­¥â­
- [x] modules/customer_hub/ - å®¢æˆ·ä¸­å°
- [x] modules/kb_service/ - çŸ¥è¯†åº“
- [x] modules/adaptive_learning/ - è‡ªé€‚åº”å­¦ä¹ 
- [x] modules/integrations/ - ç¬¬ä¸‰æ–¹é›†æˆ
- [x] modules/storage/ - æ•°æ®å­˜å‚¨
- [x] modules/adapters/ - å¾®ä¿¡é€‚é…å™¨
- [x] modules/multimodal/ - å¤šæ¨¡æ€
- [x] modules/rag/ - RAGæ£€ç´¢

### æ–‡æ¡£

- [x] docs/guides/ - ä½¿ç”¨æŒ‡å—ï¼ˆ8ä¸ªï¼‰
- [x] docs/features/ - åŠŸèƒ½æ–‡æ¡£ï¼ˆ7ä¸ªï¼‰
- [x] docs/integrations/ - é›†æˆæ–‡æ¡£ï¼ˆ5ä¸ªï¼‰
- [x] docs/erp_api/ - ERP APIï¼ˆ49ä¸ªï¼‰
- [x] docs/README.md - æ–‡æ¡£ç´¢å¼•â­

---

## ğŸ¯ ä¸‹ä¸€æ­¥è®¡åˆ’

### Phase 1: ç³»ç»Ÿæµ‹è¯•ï¼ˆæœ¬å‘¨ï¼‰

- [ ] æµ‹è¯•main.pyå®Œæ•´æµç¨‹
- [ ] æµ‹è¯•Webç•Œé¢æ‰€æœ‰åŠŸèƒ½
- [ ] æµ‹è¯•ERPåŒæ­¥
- [ ] æµ‹è¯•å¤šç»´è¡¨æ ¼åŒæ­¥

### Phase 2: åŠŸèƒ½è¡¥å…¨ï¼ˆä¸‹å‘¨ï¼‰

- [ ] è¡¥å…¨æ™ºèƒ½å¯¹è¯é—­ç¯å­¦ä¹ 
- [ ] å®ç°çŸ¥è¯†åº“è‡ªåŠ¨æ›´æ–°
- [ ] å®Œå–„å®¢æˆ·ç”»åƒåˆ†æ
- [ ] æ·»åŠ æ›´å¤šæµ‹è¯•ç”¨ä¾‹

### Phase 3: ä¼˜åŒ–è¿­ä»£ï¼ˆæœ¬æœˆï¼‰

- [ ] æ€§èƒ½ä¼˜åŒ–
- [ ] ä»£ç review
- [ ] æ–‡æ¡£å®Œå–„
- [ ] ç”¨æˆ·åé¦ˆæ”¶é›†

---

## ğŸ‰ æ€»ç»“

### âœ… å·²å®Œæˆ

1. **é¡¹ç›®æ¸…ç†**: åˆ é™¤57ä¸ªè¿‡æ—¶æ–‡ä»¶ï¼ŒèŠ‚çœ51MB
2. **ç»“æ„é‡ç»„**: core/modules/scripts/web/docsäº”å±‚æ¶æ„
3. **ä»£ç è¡¥å…¨**: æ·»åŠ é…ç½®åŠ è½½å™¨ã€ç³»ç»Ÿé›†æˆå™¨
4. **æ–‡æ¡£å®Œå–„**: 69ä¸ªæ–‡æ¡£ï¼Œä¸‰çº§åˆ†ç±»
5. **å¯¼å…¥æ›´æ–°**: æ‰€æœ‰è·¯å¾„å·²æ›´æ–°

### ğŸ¯ æ ¸å¿ƒä»·å€¼

- âœ… **æ¨¡å—åŒ–è®¾è®¡** - 11ä¸ªç‹¬ç«‹æ¨¡å—
- âœ… **ç»Ÿä¸€é…ç½®** - ç±»å‹å®‰å…¨çš„é…ç½®ç®¡ç†
- âœ… **ç³»ç»Ÿé›†æˆå™¨** - ä¸€è¡Œä»£ç åˆå§‹åŒ–
- âœ… **å®Œæ•´æ–‡æ¡£** - 69ä¸ªæ–‡æ¡£è¦†ç›–æ‰€æœ‰åŠŸèƒ½
- âœ… **ä¸“ä¸šæ¶æ„** - ä¼ä¸šçº§äº”å±‚æ¶æ„

---

**ç°åœ¨æ‚¨æ‹¥æœ‰ä¸€ä¸ªç»“æ„æ¸…æ™°ã€æ–‡æ¡£å®Œå–„ã€æ˜“äºç»´æŠ¤çš„ä¼ä¸šçº§ç³»ç»Ÿï¼** ğŸŠ

---

**æ¢³ç†å®Œæˆæ—¶é—´**: 2025-10-19 14:35  
**ç‰ˆæœ¬**: v2.0  
**å·¥ç¨‹å¸ˆ**: AI Full-Stack Engineer

